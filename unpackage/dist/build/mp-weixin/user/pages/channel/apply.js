(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["user/pages/channel/apply"],{"425a":function(t,e,n){"use strict";n.r(e);var a=n("51e2"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},"51e2":function(t,e,n){"use strict";(function(t){var a=n("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("7eb4")),r=a(n("34cf")),o=a(n("7ca3")),c=a(n("ee10")),l=n("8f59");function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){(0,o.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d={components:{},data:function(){return{tipArr:{1:[{text:"您已经成功提交申请",color:0},{text:"审核将在3个工作日内出结果，请耐心等待",color:0}],2:[{text:"恭喜您，审核通过！",color:0},{text:"您已具备".concat(this.$t("action.channelName"),"资格，快去分享体验吧~"),color:0}],3:[{text:"请联系平台管理人员询问原因",color:0}],4:[{text:"请联系平台管理人员询问失败原因",color:0}]},buttonArr:{1:[{text:"个人中心",type:"cancel"}],2:[{text:"去分享",type:"confirm"}],3:[{text:"个人中心",type:"cancel"}],4:[{text:"再次申请",type:"confirm"},{text:"个人中心",type:"cancel"}]},title:{"-1":"申请".concat(this.$t("action.channelName")),1:"等待审核",2:"",3:"取消授权",4:"申请失败"},image:{1:"https://lbqny.migugu.com/admin/public/apply_wait.jpg",2:"https://lbqny.migugu.com/admin/public/apply_suc.jpg",3:"https://lbqny.migugu.com/admin/public/apply_fail.jpg",4:"https://lbqny.migugu.com/admin/public/apply_fail.jpg"},channel_status:-1,channelInd:-1,channelList:[],isLoad:!1,options:{},form:{id:0,user_name:"",mobile:"",cate_id:"",text:"",channel_qr_id:0,admin_id:0,salesman_id:0},rule:[{name:"user_name",checkType:"isNotNull",errorMsg:"请输入您的真实姓名",regType:2},{name:"mobile",checkType:"isMobile",errorMsg:"请输入常用手机号码"}],lockTap:!1}},computed:(0,l.mapState)({primaryColor:function(t){return t.config.configInfo.primaryColor},subColor:function(t){return t.config.configInfo.subColor},configInfo:function(t){return t.config.configInfo},location:function(t){return t.user.location},scanRecordId:function(t){return t.user.scanRecordId}}),onLoad:function(e){var n=this;return(0,c.default)(i.default.mark((function a(){var r,o,c,l,u,s,d,f,p;return i.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=e,o=r.channel_qr_id,c=void 0===o?0:o,l=r.admin_id,u=void 0===l?0:l,s=r.salesman_id,d=void 0===s?0:s,u&&n.addScanRecord({type:6,qr_id:u}),d&&n.addScanRecord({type:8,qr_id:d}),!u&&!d){a.next=9;break}return a.next=6,n.updateCommonOptions(e);case 6:a.t0=a.sent,a.next=10;break;case 9:a.t0=e;case 10:return e=a.t0,n.options=e,n.form.channel_qr_id=c,n.form.admin_id=u,n.form.salesman_id=d,n.$util.showLoading(),a.next=18,n.initIndex();case 18:f=n.title,p=n.channel_status,t.setNavigationBarTitle({title:f[p]}),n.scanRecordId&&n.updateScanRecord(),n.isLoad=!0;case 22:case"end":return a.stop()}}),a)})))()},methods:s(s(s({},(0,l.mapActions)(["getConfigInfo","getUserInfo","updateCommonOptions","addScanRecord","updateScanRecord"])),(0,l.mapMutations)(["updateUserItem"])),{},{initIndex:function(){var t=arguments,e=this;return(0,c.default)(i.default.mark((function n(){var a,o,c,l,u,s,d,f,p,h,m,g,_,b,v,x,y,I;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=t.length>0&&void 0!==t[0]&&t[0],e.configInfo.id&&!a){n.next=4;break}return n.next=4,e.getConfigInfo();case 4:return o=e.configInfo.plugAuth.channelcate,n.next=7,Promise.all(o?[e.$api.channel.channelInfo(),e.$api.channel.channelCateSelect()]:[e.$api.channel.channelInfo()]);case 7:if(c=n.sent,l=(0,r.default)(c,2),u=l[0],s=l[1],d=void 0===s?[]:s,e.$util.setNavigationBarColor({bg:e.primaryColor}),d.unshift({id:0,title:"暂无接入渠道"}),e.channelList=d,u&&(!u||u.id)){n.next=18;break}return e.$util.hideAll(),n.abrupt("return");case 18:for(v in f=e.options,p=f.channel_qr_id,h=void 0===p?0:p,m=f.admin_id,g=void 0===m?0:m,_=f.salesman_id,b=void 0===_?0:_,h&&(u.channel_qr_id=h),g&&(u.admin_id=g),b&&(u.salesman_id=b),e.form)e.form[v]=u[v];e.channelInd=d.findIndex((function(t){return t.id===u.cate_id})),x=u.status,y=u.sh_text,I=h||g||b||4!=x?x:-1,e.channel_status=I,4==I&&y&&(e.tipArr[4][0].text=y),e.$util.hideAll();case 29:case"end":return n.stop()}}),n)})))()},initRefresh:function(){this.initIndex(!0)},pickerChange:function(t,e){this.channelInd=t.target.value,this.form.cate_id=this.channelList[this.channelInd].id},confirm:function(){var e=this;return(0,c.default)(i.default.mark((function n(){var a;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.channel_status,4!=a){n.next=5;break}return e.channel_status=-1,t.setNavigationBarTitle({title:"申请".concat(e.$t("action.channelName"))}),n.abrupt("return");case 5:e.$util.goUrl({url:"/user/pages/channel/income",openType:"reLaunch"});case 6:case"end":return n.stop()}}),n)})))()},validate:function(t){this.configInfo.plugAuth.channelcate;var e=new this.$util.Validate;this.rule.map((function(n){var a=n.name;e.add(t[a],n)}));var n=e.start();return n},submit:function(){var t=this;return(0,c.default)(i.default.mark((function e(){var n,a,r,o,c,l,u;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.$util.deepCopy(t.form),a=t.validate(n),!a){e.next=5;break}return t.$util.showToast({title:a}),e.abrupt("return");case 5:if(r=t.options,o=r.admin_id,c=void 0===o?0:o,l=r.salesman_id,u=void 0===l?0:l,n.admin_id=c,n.salesman_id=u,!t.lockTap){e.next=10;break}return e.abrupt("return");case 10:return t.lockTap=!0,n.text=n.text.length>300?n.text.substring(0,300):n.text,t.$util.showLoading(),e.prev=13,e.next=16,t.$api.channel.applyChannel(n);case 16:t.$util.hideAll(),t.$util.showToast({title:"提交成功"}),setTimeout((function(){t.$util.back(),t.$util.goUrl({url:"/user/pages/apply-result?type=3",openType:"redirectTo"})}),1e3),e.next=24;break;case 21:e.prev=21,e.t0=e["catch"](13),setTimeout((function(){t.lockTap=!1,t.$util.hideAll()}),2e3);case 24:case"end":return e.stop()}}),e,null,[[13,21]])})))()}})};e.default=d}).call(this,n("df3c")["default"])},a520:function(t,e,n){"use strict";(function(t,e){var a=n("47a9");n("65e9");a(n("3240"));var i=a(n("bf38"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(i.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},ac34:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,n=(t._self._c,t.isLoad?(t.options.channel_qr_id||t.options.admin_id||t.options.salesman_id)&&-1!=t.channel_status||!t.options.channel_qr_id&&!t.options.admin_id&&!t.options.salesman_id&&[1,2,3].includes(t.channel_status):null),a=t.isLoad&&!n&&t.configInfo.plugAuth.channelcate?-1!=t.channelInd&&t.channelList.length>0:null,i=t.isLoad&&!n?t.form.text.length:null,r=!t.isLoad||n||i>300?null:t.form.text.length;t._isMounted||(t.e0=function(e){return t.$util.goUrl({url:"/pages/mine",openType:"reLaunch"})}),t.$mp.data=Object.assign({},{$root:{g0:n,g1:a,g2:i,g3:r}})},i=[]},bf38:function(t,e,n){"use strict";n.r(e);var a=n("ac34"),i=n("425a");for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);var o=n("828b"),c=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);e["default"]=c.exports}},[["a520","common/runtime","common/vendor"]]]);