(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["user/pages/collect"],{"15bb":function(t,e,n){"use strict";(function(t){var a=n("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("7eb4")),o=a(n("7ca3")),r=a(n("ee10")),c=n("8f59");function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){(0,o.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var l={components:{technicianListItem:function(){n.e("components/technician-list-item").then(function(){return resolve(n("7d48"))}.bind(null,n)).catch(n.oe)},technicianListPopup:function(){n.e("components/technician-list-popup").then(function(){return resolve(n("ff93"))}.bind(null,n)).catch(n.oe)}},data:function(){return{options:{},param:{page:1,ser_id:0,coach_name:""},list:{data:[]},loading:!0}},computed:(0,c.mapState)({primaryColor:function(t){return t.config.configInfo.primaryColor},subColor:function(t){return t.config.configInfo.subColor},configInfo:function(t){return t.config.configInfo},userInfo:function(t){return t.user.userInfo},location:function(t){return t.user.location},locaRefuse:function(t){return t.user.locaRefuse},userCoachStatus:function(t){return t.user.userCoachStatus},changeOnAddr:function(t){return t.user.changeOnAddr},noChangeLoca:function(t){return t.user.noChangeLoca}}),onLoad:function(){this.$util.showLoading(),this.initIndex()},onShow:function(){var t=this;return(0,r.default)(i.default.mark((function e(){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:!t.location.lat&&t.locaRefuse&&t.toResetUtilLoca();case 1:case"end":return e.stop()}}),e)})))()},onPullDownRefresh:function(){t.showNavigationBarLoading(),this.initRefresh(),t.stopPullDownRefresh()},onReachBottom:function(){this.list.current_page>=this.list.last_page||this.loading||(this.param.page=this.param.page+1,this.loading=!0,this.getList())},watch:{locaRefuse:function(t,e){t||this.toResetUtilLoca()},changeOnAddr:function(t,e){var n=this.noChangeLoca.noloca;t&&n&&this.initUtilLocaData()},noChangeLoca:function(t,e){var n=this;setTimeout((function(){var t=n.changeOnAddr,e=t.lat,a=t.lng,i=t.unix,o=void 0===i?0:i,r=n.noChangeLoca.noloca,c=n.$util.DateToUnix(n.$util.formatTime(new Date,"YY-M-D h:m:s"));r&&(!e&&!a||!o||o&&c-o>=1)&&n.getUtilLocation()}),800)}},methods:s(s(s({},(0,c.mapActions)([])),(0,c.mapMutations)(["updateUserItem","updateMapItem"])),{},{initIndex:function(){var e=arguments,n=this;return(0,r.default)(i.default.mark((function a(){return i.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.length>0&&void 0!==e[0]&&e[0],a.next=3,n.getList();case 3:n.$util.setNavigationBarColor({bg:n.primaryColor}),t.setNavigationBarTitle({title:"收藏"+n.$t("action.attendantName")});case 5:case"end":return a.stop()}}),a)})))()},initRefresh:function(){this.param.page=1,this.initIndex(!0)},toResetUtilLoca:function(){return(0,r.default)(i.default.mark((function t(){return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()},toOpenLocation:function(){var t=this;return(0,r.default)(i.default.mark((function e(){var n;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.$refs.user_privacy.check(),!n){e.next=4;break}return t.$refs.user_privacy.open(),e.abrupt("return");case 4:return e.next=6,t.$util.checkAuth({type:"userLocation",checkApp:!0});case 6:t.initIndex();case 7:case"end":return e.stop()}}),e)})))()},toSearch:function(t){this.param.page=1,this.param.coach_name=t,this.getList()},getList:function(){var t=this;return(0,r.default)(i.default.mark((function e(){var n,a,o,r,c,u,s,l,f,d,p,h,g,m;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.location,a=t.userCoachStatus,o=a.status,r=a.coach_position,1!=t.param.page||n.lat&&(!n.lat||"暂未获取到位置信息"!=n.address)){e.next=17;break}if(2!=o||!r){e.next=14;break}if(c=t.changeOnAddr,u=c.lat,s=void 0===u?0:u,l=c.lng,f=void 0===l?0:l,d=c.unix,p=void 0===d?0:d,h=t.$util.DateToUnix(t.$util.formatTime(new Date,"YY-M-D h:m:s")),g=!(s&&f&&p&&h-p<3),g||(m=Object.assign({},t.location,{lat:s,lng:f,is_util_loca:1}),t.updateUserItem({key:"location",val:m})),t.updateUserItem({key:"noChangeLoca",val:{noloca:g}}),!t.noChangeLoca.noloca){e.next=11;break}return e.abrupt("return");case 11:t.initUtilLocaData(),e.next=15;break;case 14:t.getUtilLocation();case 15:return t.updateMapItem({key:"pageActive",val:!1}),e.abrupt("return");case 17:t.initUtilLocaData();case 18:case"end":return e.stop()}}),e)})))()},getUtilLocation:function(){var t=this;return(0,r.default)(i.default.mark((function e(){var n,a,o,r,c,u;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$util.getLocation();case 2:n=e.sent,a=n.lat,o=void 0===a?0:a,r=n.lng,c=void 0===r?0:r,u=Object.assign({},t.location,{lat:o,lng:c,is_util_loca:1}),t.updateUserItem({key:"location",val:u}),t.initUtilLocaData();case 10:case"end":return e.stop()}}),e)})))()},initUtilLocaData:function(){var t=this;return(0,r.default)(i.default.mark((function e(){var n,a,o,r,c,u,s,l,f,d;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.updateUserItem({key:"noChangeLoca",val:{noloca:!1}}),n=t.list,a=t.param,o=t.location,r=o.lng,c=void 0===r?0:r,u=o.lat,s=void 0===u?0:u,l=o.is_util_loca,f=void 0===l?0:l,a=Object.assign({},a,{lat:s,lng:c}),e.next=6,t.$api.mine.coachCollectList(a);case 6:d=e.sent,d.data.map((function(t){t.is_collect=1})),1==t.param.page||(d.data=n.data.concat(d.data)),t.list=d,t.loading=!1,t.$util.hideAll(),1==a.page&&s&&c&&f&&t.$util.getMapInfo();case 12:case"end":return e.stop()}}),e)})))()},handerTabChange:function(t){this.activeIndex=t,this.$util.showLoading(),this.param.page=1,this.getList()},toShowPopup:function(t,e){var n=this;return(0,r.default)(i.default.mark((function a(){return i.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n.$refs.technician_list_popup.toShowPopup(n.list.data[t],e);case 1:case"end":return a.stop()}}),a)})))()},toCollect:function(t){var e=this;return(0,r.default)(i.default.mark((function n(){var a,o;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.list.data[t],o=a.id,a.is_collect,a.collect_num,n.next=3,e.$api.mine.delCollect({coach_id:o});case 3:e.$util.showToast({title:"取消成功"}),e.list.data.splice(t,1);case 5:case"end":return n.stop()}}),n)})))()}})};e.default=l}).call(this,n("df3c")["default"])},3080:function(t,e,n){},"4e32":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,n=(t._self._c,t.list.data&&t.list.data.length>0),a=n?[2,3].includes(t.configInfo.coach_list_format):null,i=n?t.__map(t.list.data,(function(e,n){var a=t.__get_orig(e),i=1===t.configInfo.coach_list_format&&0!=n||[2,3].includes(t.configInfo.coach_list_format),o=[2,3].includes(t.configInfo.coach_list_format)&&n%2==0;return{$orig:a,g2:i,g3:o}})):null,o=t.loading?t.list.current_page>=t.list.last_page&&t.list.data.length>0&&t.location.lng:null,r=!t.loading&&t.list.data.length<=0&&1==t.list.current_page,c=!r||t.location.lat||t.location.lng?null:t.$t("action.attendantName");t.$mp.data=Object.assign({},{$root:{g0:n,g1:a,l0:i,g4:o,g5:r,m0:c}})},i=[]},"5ae6":function(t,e,n){"use strict";(function(t,e){var a=n("47a9");n("65e9");a(n("3240"));var i=a(n("f4e8"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(i.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"7d1a":function(t,e,n){"use strict";n.r(e);var a=n("15bb"),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a},a0ca:function(t,e,n){"use strict";var a=n("3080"),i=n.n(a);i.a},f4e8:function(t,e,n){"use strict";n.r(e);var a=n("4e32"),i=n("7d1a");for(var o in i)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(o);n("a0ca");var r=n("828b"),c=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);e["default"]=c.exports}},[["5ae6","common/runtime","common/vendor"]]]);