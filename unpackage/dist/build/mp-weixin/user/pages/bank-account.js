(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["user/pages/bank-account"],{"05ed":function(e,t,r){"use strict";r.r(t);var a=r("a269"),n=r.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return a[e]}))}(i);t["default"]=n.a},"0bc0":function(e,t,r){"use strict";(function(e,t){var a=r("47a9");r("65e9");a(r("3240"));var n=a(r("d9ff"));e.__webpack_require_UNI_MP_PLUGIN__=r,t(n.default)}).call(this,r("3223")["default"],r("df3c")["createPage"])},"1aaf":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement,r=(e._self._c,e.isLoad&&1===e.form.is_company&&e.form.attach_file?e._f("handleFileText")(e.form.attach_file):null);e._isMounted||(e.e0=function(t,r){var a=arguments[arguments.length-1].currentTarget.dataset,n=a.eventParams||a["event-params"];r=n.item;t.stopPropagation(),!e.form.bid&&e.toSetItem("is_company",r.id)},e.e1=function(t){return t.stopPropagation(),e.$util.goUrl({url:"/user/pages/choose-adapay-city?key=area"})},e.e2=function(t,r){var a=arguments[arguments.length-1].currentTarget.dataset,n=a.eventParams||a["event-params"];r=n.item;t.stopPropagation(),!e.form.bid&&e.toSetItem("bank_acct_type",r.id)},e.e3=function(t){return t.stopPropagation(),e.$util.goUrl({url:"/user/pages/choose-adapay-city?key=bank_area"})},e.e4=function(t){return t.stopPropagation(),e.$util.goUrl({url:"https://docs.adapay.tech/api/appendix.html#bank-code",openType:"web"})}),e.$mp.data=Object.assign({},{$root:{f0:r}})},n=[]},"723d":function(e,t,r){"use strict";var a=r("db34"),n=r.n(a);n.a},a269:function(e,t,r){"use strict";(function(e){var a=r("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r("7eb4")),i=a(r("7ca3")),o=a(r("ee10")),c=r("8f59"),s=(a(r("56ce")),a(r("e93e")));function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d={data:function(){return{isLoad:!1,options:{},areaOptions:s.default,typeList:[{id:1,title:"个体户/企业"},{id:2,title:"个人"}],accTypeList:[{id:1,title:"对公"},{id:2,title:"对私"}],codeTypeList:[{id:1,title:"永久有效"},{id:2,title:"有效时间"}],member_info:["is_company","member_id","order_no","name","social_credit_code","social_credit_code_expires","business_scope","legal_person","legal_cert_id","legal_cert_id_expires","legal_mp","address","attach_file"],bank_info:["member_id","settle_account_id","bank_acct_type","card_id","card_name","cert_id","tel_no","bank_code","bank_name"],form:{id:"",mid:"",bid:"",is_company:1,member_id:"",order_no:"",settle_account_id:"",name:"",social_credit_code:"",social_credit_code_expires:"",business_scope:"",legal_person:"",legal_cert_id:"",legal_cert_id_expires:"",legal_mp:"",address:"",attach_file:"",area:[],area_text:"",card_id:"",card_name:"",cert_id:"",tel_no:"",bank_code:"",bank_name:"",bank_acct_type:1,bank_area:[],bank_area_text:""},rule:[{name:"name",checkType:"isNotNull",errorMsg:"请输入商户名称",regType:2},{name:"social_credit_code",checkType:"isNotNull",errorMsg:"请输入统一社会信用代码",regType:2},{name:"social_credit_code_expires",checkType:"isNotNull",errorMsg:"请选择统一社会信用证有效期"},{name:"area",checkType:"isNotNull",errorMsg:"请选择所在区域"},{name:"business_scope",checkType:"isNotNull",errorMsg:"请输入经营范围",regType:2},{name:"legal_person",checkType:"isNotNull",errorMsg:"请输入法人名称",regType:2},{name:"legal_mp",checkType:"isMobile",errorMsg:"请输入法人手机号"},{name:"legal_cert_id",checkType:"isIdCard",errorMsg:"请输入法人身份证号"},{name:"legal_cert_id_expires",checkType:"isNotNull",errorMsg:"请选择法人身份证有效期"},{name:"address",checkType:"isNotNull",errorMsg:"请输入企业地址",regType:2},{name:"attach_file",checkType:"isNotNull",errorMsg:"请上传附件"},{name:"card_id",checkType:"isNotNull",errorMsg:"请输入结算账户银行卡号"},{name:"bank_area",checkType:"isNotNull",errorMsg:"请选择开户银行所在地"},{name:"bank_code",checkType:"isNotNull",errorMsg:"请输入银行编码"},{name:"card_name",checkType:"isNotNull",errorMsg:"请输入银行卡户名"},{name:"tel_no",checkType:"isMobile",errorMsg:"请输入手机号"},{name:"cert_id",checkType:"isIdCard",errorMsg:"请输入身份证号"}],lockTap:!1}},computed:(0,c.mapState)({primaryColor:function(e){return e.config.configInfo.primaryColor},subColor:function(e){return e.config.configInfo.subColor},configInfo:function(e){return e.config.configInfo},userInfo:function(e){return e.user.userInfo},autograph:function(e){return e.user.autograph},location:function(e){return e.user.location}}),onLoad:function(e){var t=this;return(0,o.default)(n.default.mark((function r(){return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.$util.showLoading(),t.options=e,r.next=4,t.initIndex();case 4:t.isLoad=!0;case 5:case"end":return r.stop()}}),r)})))()},methods:u(u(u({},(0,c.mapActions)(["getConfigInfo","getUserInfo"])),(0,c.mapMutations)(["updateUserItem"])),{},{initIndex:function(){var e=arguments,t=this;return(0,o.default)(n.default.mark((function r(){var a,i,o,c,s,l,u,d,_,p,f,m,b,g,h,k,y,v,x,T,w,$;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.length>0&&void 0!==e[0]&&e[0],r.next=3,t.$api.mine.memberInfo();case 3:if(a=r.sent,a&&a.hasOwnProperty("member_info")&&a.hasOwnProperty("bank_info"))for($ in i=a.member_info.is_company,o=a.bank_info.bank_acct_type,c=[],s="",l=[],u="",d=t.areaOptions,1===i&&(_=a.member_info,p=_.prov_code,f=_.area_code,c=[p,f],m=d.findIndex((function(e){return e.value===c[0]})),b=d[m].cities.findIndex((function(e){return e.value===c[1]})),s="".concat(d[m].title," ").concat(d[m].cities[b].title)),1==o&&(g=a.bank_info,h=g.prov_code,k=g.area_code,l=[h,k],y=d.findIndex((function(e){return e.value===l[0]})),v=d[y].cities.findIndex((function(e){return e.value===l[1]})),u="".concat(d[y].title," ").concat(d[y].cities[v].title)),x=Object.assign({},a.member_info,a.bank_info),1===i&&(T=x.social_credit_code_expires,w=x.legal_cert_id_expires,x.social_credit_code_expires=T.substring(0,4)+"-"+T.substring(4,6)+"-"+T.substring(6,8),x.legal_cert_id_expires=w.substring(0,4)+"-"+w.substring(4,6)+"-"+w.substring(6,8)),x.area=c,x.bank_area=l,x.area_text=s,x.bank_area_text=u,x.mid=a.member_info.id,x.bid=a.bank_info.id,t.form)x[$]=null==x[$]?"":x[$],t.form[$]=x[$];t.$util.hideAll(),t.$util.setNavigationBarColor({bg:t.primaryColor});case 7:case"end":return r.stop()}}),r)})))()},initRefresh:function(){this.initIndex(!0)},toSetItem:function(e,t){this.form[e]=t,"is_company"==e&&(this.form.bank_acct_type=t)},pickerChange:function(e,t){var r=e.target.value;this.form[t]=r},toChooseFile:function(){var t=this;e.chooseMessageFile({count:1,type:"file",extension:["zip"],success:function(e){return(0,o.default)(n.default.mark((function r(){return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.toUploadFile(e.tempFiles[0]);case 1:case"end":return r.stop()}}),r)})))()}})},toUploadFile:function(e){var t=this;return(0,o.default)(n.default.mark((function r(){var a,i,o,c,s,l;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.$util.showLoading(),a=e.path,i=void 0===a?"":a,o=e.name,void 0===o?"":o,c=i,/\.(zip)$/.test(c)){r.next=6;break}return t.$util.showToast({title:"附件仅支持zip格式哦"}),r.abrupt("return");case 6:return r.next=8,t.$api.base.uploadFile({filePath:i,formData:{type:"cert"}});case 8:s=r.sent,l=s.attachment_path,t.form.attach_file=l,t.$util.hideAll();case 12:case"end":return r.stop()}}),r)})))()},validate:function(e){var t=e.is_company,r=e.bank_acct_type,a=["name","social_credit_code","social_credit_code_expires","business_scope","legal_person","legal_cert_id","legal_cert_id_expires","legal_mp","address","attach_file","area"],n=1==r?["card_id","card_name","tel_no","bank_area","bank_code"]:["card_id","card_name","cert_id","tel_no"],i=new this.$util.Validate;this.rule.map((function(r){var o=r.name;(1===t&&(a.includes(o)||n.includes(o))||2===t&&n.includes(o))&&i.add(e[o],r)}));var o=i.start();return o},submit:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var r,a,i,o,c,s,l,u,d,_,p,f,m,b,g,h;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.$util.deepCopy(e.form),a=e.validate(r),!a){t.next=5;break}return e.$util.showToast({title:a}),t.abrupt("return");case 5:if(!e.lockTap){t.next=7;break}return t.abrupt("return");case 7:if(e.lockTap=!0,e.$util.showLoading(),t.prev=9,r.id,i=r.mid,o=r.bid,c=r.is_company,s=r.bank_acct_type,l=r.area,u=r.bank_area,!(1===c&&l.length<2||1===s&&u.length<2)){t.next=15;break}return d=l.length<2?"所在区域":"开户银行所在地",e.$util.showToast({title:"".concat(d," 请选择具体的省市区")}),t.abrupt("return");case 15:if(1!==c||/\.(zip)$/.test(r.attach_file)){t.next=18;break}return e.$util.showToast({title:"附件仅支持zip格式!"}),t.abrupt("return");case 18:return _=r.bid?"memberUpdate":"memberAdd",p=e.$util.pick(r,1===c?e.member_info:["is_company","member_id"]),f=e.$util.pick(r,e.bank_info),1===c&&(p.prov_code=l[0],p.area_code=l[1]),p.id=i,f.prov_code=1===s?u[0]:"",f.area_code=1===s?u[1]:"",f.id=o,1===c&&(m=p.social_credit_code_expires,b=p.legal_cert_id_expires,g=m.split("-"),p.social_credit_code_expires="".concat(g[0]).concat(g[1]).concat(g[2]),h=b.split("-"),p.legal_cert_id_expires="".concat(h[0]).concat(h[1]).concat(h[2])),t.next=29,e.$api.mine[_]({member_info:p,bank_info:f});case 29:e.$util.hideAll(),e.$util.showToast({title:"提交成功"}),setTimeout((function(){e.$util.back(),e.$util.goUrl({url:1,openType:"navigateBack"})}),1e3),t.next=37;break;case 34:t.prev=34,t.t0=t["catch"](9),setTimeout((function(){e.lockTap=!1,e.$util.hideAll()}),2e3);case 37:case"end":return t.stop()}}),t,null,[[9,34]])})))()}}),filters:{handleFileText:function(e){var t="请上传附件";return e&&(t=e.substring(e.lastIndexOf("/")+1)),t}}};t.default=d}).call(this,r("df3c")["default"])},d9ff:function(e,t,r){"use strict";r.r(t);var a=r("1aaf"),n=r("05ed");for(var i in n)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(i);r("723d");var o=r("828b"),c=Object(o["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);t["default"]=c.exports},db34:function(e,t,r){}},[["0bc0","common/runtime","common/vendor"]]]);