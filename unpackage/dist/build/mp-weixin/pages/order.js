(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order"],{"0fbc":function(e,t,n){"use strict";(function(e,t){var r=n("47a9");n("65e9");r(n("3240"));var a=r(n("ec9a"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"5ff0":function(e,t,n){"use strict";(function(e){var r=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("7eb4")),i=r(n("7ca3")),o=r(n("ee10")),u=n("8f59");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={components:{tabbar:function(){n.e("components/tabbar").then(function(){return resolve(n("a1b6"))}.bind(null,n)).catch(n.oe)}},data:function(){return{options:{},navTitle:"",statusType:{"-1":"已取消",1:"待支付",2:"待接单",3:"待服务",4:this.$t("action.attendantName")+"出发",5:this.$t("action.attendantName")+"到达",6:"服务中",7:"已完成",8:"待转单"},loading:!0,popupInfo:{},lockTap:!1}},computed:(0,u.mapState)({activeIndex:function(e){return e.order.activeIndex},tabList:function(e){return e.order.tabList},param:function(e){return e.order.param},list:function(e){return e.order.list},primaryColor:function(e){return e.config.configInfo.primaryColor},subColor:function(e){return e.config.configInfo.subColor},configInfo:function(e){return e.config.configInfo},userInfo:function(e){return e.user.userInfo}}),onLoad:function(e){var t=this;return(0,o.default)(a.default.mark((function n(){var r,i,o,u,c;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.tab,i=void 0===r?0:r,t.updateOrderItem({key:"activeIndex",val:i}),n.next=4,t.initIndex();case 4:o=t.configInfo.tabBar,u=o.findIndex((function(e){return 4==e.id})),c=-1==u?"订单":o[u].name,t.navTitle=c;case 8:case"end":return n.stop()}}),n)})))()},onPullDownRefresh:function(){e.showNavigationBarLoading(),this.initRefresh(),e.stopPullDownRefresh()},onReachBottom:function(){this.list.current_page>=this.list.last_page||this.loading||(this.loading=!0,this.getList(this.param.page+1))},methods:s(s(s({},(0,u.mapActions)(["getConfigInfo","getOrderList"])),(0,u.mapMutations)(["updateOrderItem"])),{},{initIndex:function(){var e=arguments,t=this;return(0,o.default)(a.default.mark((function n(){var r;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.length>0&&void 0!==e[0]&&e[0],t.configInfo.id&&!r){n.next=4;break}return n.next=4,t.getConfigInfo();case 4:return n.next=6,t.getList(1);case 6:case"end":return n.stop()}}),n)})))()},initRefresh:function(){var e=this;return(0,o.default)(a.default.mark((function t(){var n,r,i;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.initIndex(!0);case 2:n=e.configInfo.tabBar,r=n.findIndex((function(e){return 4==e.id})),i=-1==r?"订单":n[r].name,e.navTitle=i;case 6:case"end":return t.stop()}}),t)})))()},getList:function(){var e=arguments,t=this;return(0,o.default)(a.default.mark((function n(){var r,i,o,u,c;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:0,r&&(i=t.$util.deepCopy(t.param),i.page=r,t.updateOrderItem({key:"param",val:i})),t.list,o=t.param,u=t.tabList,c=t.activeIndex,o.pay_type=u[c].id,n.prev=4,n.next=7,t.getOrderList(o);case 7:t.loading=!1,t.$util.hideAll(),n.next=15;break;case 11:n.prev=11,n.t0=n["catch"](4),t.loading=!1,t.$util.hideAll();case 15:case"end":return n.stop()}}),n,null,[[4,11]])})))()},handerTabChange:function(t){this.updateOrderItem({key:"activeIndex",val:t}),e.pageScrollTo({scrollTop:0}),this.$util.showLoading(),this.getList(1)},toChangeItem:function(e,t){var n=this;return(0,o.default)(a.default.mark((function r(){var i,o,u,c,s;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!n.lockTap){r.next=2;break}return r.abrupt("return");case 2:i=n.list.data[e],o=i.id,u=i.order_code,c=i.order_goods,i.pay_type,s=c[0].goods_cover,n.popupInfo={id:o,name:"系统单号：".concat(u),image:s,index:e,refs_key:t},n.$refs[t].open();case 6:case"end":return r.stop()}}),r)})))()},confirmOperItem:function(){var e=this;return(0,o.default)(a.default.mark((function t(){var n,r,i,o,u,c,s,l;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.popupInfo,r=n.id,i=n.index,o=n.refs_key,u={cancel_item:["cancelOrder","取消成功",-1],del_item:["delOrder","删除成功",-1],end_item:["endOrder","完成成功",7]},c=u[o][0],s=u[o][1],l=u[o][2],!e.lockTap){t.next=7;break}return t.abrupt("return");case 7:return e.lockTap=!0,t.prev=8,e.$refs[o].close(),t.next=12,e.$api.order[c]({id:r});case 12:0==e.activeIndex&&"del_item"!==o?e.list.data[i].pay_type=l:e.list.data.splice(i,1),e.$util.showToast({title:s}),setTimeout((function(){e.lockTap=!1}),1e3),t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](8),setTimeout((function(){e.getList(1),e.lockTap=!1}),2e3);case 20:case"end":return t.stop()}}),t,null,[[8,17]])})))()},toPay:function(e){var t=this;return(0,o.default)(a.default.mark((function n(){var r,i,o,u,c;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.lockTap){n.next=2;break}return n.abrupt("return");case 2:return t.lockTap=!0,t.$util.showLoading(),r=t.list.data[e],i=r.id,o=r.pay_model,n.prev=5,n.next=8,t.$api.order.rePayOrder({id:i});case 8:if(u=n.sent,c=u.pay_list,t.$util.hideAll(),!c){n.next=26;break}return 3==o&&(c={orderInfo:c,provider:"alipay"}),n.prev=13,n.next=16,t.$util.pay(c);case 16:t.$util.showToast({title:"支付成功"}),0==t.activeIndex?t.list.data[e].pay_type=2:t.list.data.splice(e,1),t.lockTap=!1,n.next=26;break;case 21:return n.prev=21,n.t0=n["catch"](13),t.$util.showToast({title:"支付失败"}),t.lockTap=!1,n.abrupt("return");case 26:n.next=31;break;case 28:n.prev=28,n.t1=n["catch"](5),setTimeout((function(){t.lockTap=!1,t.$util.hideAll()}),2e3);case 31:case"end":return n.stop()}}),n,null,[[5,28],[13,21]])})))()},toHx:function(e){var t=this;return(0,o.default)(a.default.mark((function n(){var r,i,o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.list.data[e],i=r.id,o=r.qr,t.popupInfo={id:i,image:o},t.$refs.hx_item.open();case 3:case"end":return n.stop()}}),n)})))()},goDetail:function(e,t){var n=this.list.data[e].id,r="/user/pages/order/".concat(t,"?id=").concat(n);this.$util.goUrl({url:r})},toAgain:function(e){var t=this;return(0,o.default)(a.default.mark((function n(){var r,i,o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.list.data[e],i=r.id,o=r.coach_id,n.next=3,t.$api.order.onceMoreOrder({order_id:i});case 3:t.$util.goUrl({url:"/user/pages/order?id=".concat(o)});case 4:case"end":return n.stop()}}),n)})))()},toCopy:function(e){var t=this.$refs.user_privacy.check();t?this.$refs.user_privacy.open():this.$util.goUrl({url:e,openType:"copy"})}})};t.default=l}).call(this,n("df3c")["default"])},9555:function(e,t,n){"use strict";n.r(t);var r=n("5ff0"),a=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=a.a},"9f7b":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var r=function(){var e=this,t=e.$createElement,n=(e._self._c,e.tabList.length),r=e.__map(e.list.data,(function(t,n){var r=e.__get_orig(t),a=1!=t.pay_type?[2,3,4,5,6].includes(t.pay_type):null,i=t.order_goods.length,o=e.$t("action.attendantName"),u=t.order_goods.length;return{$orig:r,g1:a,g2:i,m0:o,g3:u}})),a=e.loading?e.list.current_page>=e.list.last_page&&e.list.data.length>0:null,i=!e.loading&&e.list.data.length<=0&&1==e.list.current_page;e._isMounted||(e.e0=function(t,n){var r=arguments[arguments.length-1].currentTarget.dataset,a=r.eventParams||r["event-params"];n=a.item;return t.stopPropagation(),e.$util.goUrl({url:"/user/pages/bell/list?id="+n.id+"&coach_id="+n.coach_id})}),e.$mp.data=Object.assign({},{$root:{g0:n,l0:r,g4:a,g5:i}})},a=[]},ec9a:function(e,t,n){"use strict";n.r(t);var r=n("9f7b"),a=n("9555");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var o=n("828b"),u=Object(o["a"])(a["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],void 0);t["default"]=u.exports}},[["0fbc","common/runtime","common/vendor"]]]);