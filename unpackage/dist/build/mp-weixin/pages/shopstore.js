(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shopstore"],{"037b":function(t,e,n){"use strict";(function(t,e){var a=n("47a9");n("65e9");a(n("3240"));var i=a(n("698f"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(i.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"05c4":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,n=(t._self._c,t.isLoad&&t.configInfo.plugAuth.store?t.cateList.length:null),a=t.isLoad&&t.configInfo.plugAuth.store&&t.loading?t.list.current_page>=t.list.last_page&&t.list.data.length>0:null,i=t.isLoad&&t.configInfo.plugAuth.store?!t.loading&&t.list.data.length<=0&&1==t.list.current_page:null;t.$mp.data=Object.assign({},{$root:{g0:n,g1:a,g2:i}})},i=[]},"698f":function(t,e,n){"use strict";n.r(e);var a=n("05c4"),i=n("9ff4");for(var o in i)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(o);var r=n("828b"),u=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);e["default"]=u.exports},7016:function(t,e,n){"use strict";(function(t){var a=n("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("7eb4")),o=a(n("7ca3")),r=a(n("ee10")),u=n("8f59"),c=a(n("56ce"));function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){(0,o.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={components:{shopstoreListItem:function(){n.e("components/shopstore-list-item").then(function(){return resolve(n("dba4"))}.bind(null,n)).catch(n.oe)},tabbar:function(){n.e("components/tabbar").then(function(){return resolve(n("a1b6"))}.bind(null,n)).catch(n.oe)}},data:function(){return{isLoad:!1,options:{},navTitle:"",loading:!0,lockTap:!1}},computed:(0,u.mapState)({pageActive:function(t){return t.shopstore.pageActive},cateList:function(t){return t.shopstore.cateList},param:function(t){return t.shopstore.param},list:function(t){return t.shopstore.list},primaryColor:function(t){return t.config.configInfo.primaryColor},subColor:function(t){return t.config.configInfo.subColor},configInfo:function(t){return t.config.configInfo},autograph:function(t){return t.user.autograph},userInfo:function(t){return t.user.userInfo},location:function(t){return t.user.location},locaRefuse:function(t){return t.user.locaRefuse},isGzhLogin:function(t){return t.user.isGzhLogin},userCoachStatus:function(t){return t.user.userCoachStatus},changeOnAddr:function(t){return t.user.changeOnAddr},noChangeLoca:function(t){return t.user.noChangeLoca}}),onLoad:function(e){var n=this;return(0,r.default)(i.default.mark((function a(){var o,r,u;return i.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n.$util.showLoading(),n.options=e,n.$util.showLoading(),a.next=5,n.initIndex();case 5:o=n.configInfo.tabBar,r=o.findIndex((function(t){return 6==t.id})),u=-1==r?"门店":o[r].name,n.navTitle=u,t.setNavigationBarTitle({title:u}),n.updateShopstoreItem({key:"pageActive",val:!0});case 11:case"end":return a.stop()}}),a)})))()},onShow:function(){var t=this;return(0,r.default)(i.default.mark((function e(){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:!t.location.lat&&t.locaRefuse&&t.toResetUtilLoca();case 1:case"end":return e.stop()}}),e)})))()},onPullDownRefresh:function(){t.showNavigationBarLoading(),this.initRefresh(),t.stopPullDownRefresh()},onReachBottom:function(){this.list.current_page>=this.list.last_page||this.loading||(this.param.page=this.param.page+1,this.loading=!0,this.getList())},onShareAppMessage:function(t){var e=this.userInfo.id,n=void 0===e?0:e,a="/pages/shopstore?pid=".concat(n);return this.$util.log(a),{title:"",imageUrl:"",path:a}},watch:{locaRefuse:function(t,e){t||this.toResetUtilLoca()},changeOnAddr:function(t,e){var n=this.noChangeLoca.noloca;t&&n&&this.initUtilLocaData()},noChangeLoca:function(t,e){var n=this;setTimeout((function(){var t=n.changeOnAddr,e=t.lat,a=t.lng,i=t.unix,o=void 0===i?0:i,r=n.noChangeLoca.noloca,u=n.$util.DateToUnix(n.$util.formatTime(new Date,"YY-M-D h:m:s"));r&&(!e&&!a||!o||o&&u-o>=1)&&n.getUtilLocation()}),800)}},methods:l(l(l({},(0,u.mapActions)(["getConfigInfo","getUserInfo","getShopstoreIndex","getShopstoreList"])),(0,u.mapMutations)(["updateUserItem","updateServiceItem","updateTechnicianItem","updateMapItem","updateDynamicItem","updateShopstoreItem"])),{},{initIndex:function(){var t=arguments,e=this;return(0,r.default)(i.default.mark((function n(){var a,o,r,u,c,s,l;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=t.length>0&&void 0!==t[0]&&t[0],o=e.options.pid,r=void 0===o?0:o,a||!e.pageActive||r){n.next=8;break}return e.$util.setNavigationBarColor({bg:e.primaryColor}),e.isLoad=!0,e.loading=!1,e.$util.hideAll(),n.abrupt("return");case 8:if(e.isGzhLogin,u=e.userInfo.id,c=void 0===u?0:u,!r||c){n.next=13;break}return n.next=13,e.getUserInfo();case 13:if(e.configInfo.id&&!a&&(!e.configInfo.id||e.configInfo.plugAuth.hasOwnProperty("store"))){n.next=16;break}return n.next=16,e.getConfigInfo();case 16:if(e.$util.setNavigationBarColor({bg:e.primaryColor}),s=e.configInfo.plugAuth.store,l=void 0!==s&&s,l){n.next=23;break}return e.isLoad=!0,e.loading=!1,e.$util.hideAll(),n.abrupt("return");case 23:return n.next=25,Promise.all([e.getShopstoreIndex(),e.getList(1)]);case 25:case"end":return n.stop()}}),n)})))()},initRefresh:function(){var e=this;return(0,r.default)(i.default.mark((function n(){var a,o,r;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.initIndex(!0);case 2:a=e.configInfo.tabBar,o=a.findIndex((function(t){return 6==t.id})),r=-1==o?"门店":a[o].name,e.navTitle=r,t.setNavigationBarTitle({title:r});case 7:case"end":return n.stop()}}),n)})))()},toResetUtilLoca:function(){return(0,r.default)(i.default.mark((function t(){return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()},toOpenLocation:function(){var t=this;return(0,r.default)(i.default.mark((function e(){var n;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.$refs.user_privacy.check(),!n){e.next=4;break}return t.$refs.user_privacy.open(),e.abrupt("return");case 4:return e.next=6,t.$util.checkAuth({type:"userLocation",checkApp:!0});case 6:t.initRefresh();case 7:case"end":return e.stop()}}),e)})))()},toAppShare:function(){var t=this,e=this.userInfo.id,n=void 0===e?0:e,a=c.default.siteroot,i=a.split("/index.php")[0],o="".concat(i,"/h5/#/pages/shopstore?pid=").concat(n);this.$jweixin.wxReady((function(){t.$jweixin.showOptionMenu(),t.$jweixin.shareAppMessage("动态","",o,""),t.$jweixin.shareTimelineMessage("动态",o,"")}))},toSearch:function(t){this.param.title=t,this.getList(1)},getList:function(t){var e=this;return(0,r.default)(i.default.mark((function n(){var a,o,r,u,c,s,l,f,p,d,h,g,v,m,b;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t&&(e.param.page=1,e.list.data=[]),a=e.location,e.locaRefuse,o=e.userCoachStatus,r=o.status,u=o.coach_position,1!=e.param.page||a.lat&&(!a.lat||"暂未获取到位置信息"!=a.address)){n.next=25;break}if(c=e.$refs.user_privacy.check(),!c){n.next=11;break}return e.$refs.user_privacy.open(),e.isLoad=!0,e.loading=!1,e.$util.hideAll(),n.abrupt("return");case 11:if(2!=r||!u){n.next=22;break}if(s=e.changeOnAddr,l=s.lat,f=void 0===l?0:l,p=s.lng,d=void 0===p?0:p,h=s.unix,g=void 0===h?0:h,v=e.$util.DateToUnix(e.$util.formatTime(new Date,"YY-M-D h:m:s")),m=!(f&&d&&g&&v-g<3),m||(b=Object.assign({},e.location,{lat:f,lng:d,is_util_loca:1}),e.updateUserItem({key:"location",val:b})),e.updateUserItem({key:"noChangeLoca",val:{noloca:m}}),!e.noChangeLoca.noloca){n.next=19;break}return n.abrupt("return");case 19:e.initUtilLocaData(),n.next=23;break;case 22:e.getUtilLocation();case 23:return e.updateMapItem({key:"pageActive",val:!1}),n.abrupt("return");case 25:e.initUtilLocaData();case 26:case"end":return n.stop()}}),n)})))()},getUtilLocation:function(){var t=this;return(0,r.default)(i.default.mark((function e(){var n,a,o,r,u,c;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$util.getLocation();case 2:n=e.sent,a=n.lat,o=void 0===a?0:a,r=n.lng,u=void 0===r?0:r,c=Object.assign({},t.location,{lat:o,lng:u,is_util_loca:1}),t.updateUserItem({key:"location",val:c}),t.initUtilLocaData();case 10:case"end":return e.stop()}}),e)})))()},initUtilLocaData:function(){var t=this;return(0,r.default)(i.default.mark((function e(){var n,a,o,r,u,c,s,l;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.updateUserItem({key:"noChangeLoca",val:{noloca:!1}}),n=t.location,a=n.lat,o=void 0===a?0:a,r=n.lng,u=void 0===r?0:r,c=n.is_util_loca,s=void 0===c?0:c,t.list,l=Object.assign({},t.param,{lat:o,lng:u}),e.next=6,t.getShopstoreList(l);case 6:t.isLoad=!0,t.loading=!1,t.$util.hideAll(),1==l.page&&o&&u&&s&&t.$util.getMapInfo();case 10:case"end":return e.stop()}}),e)})))()},goCate:function(t){var e=t.id,n=t.title,a="/shopstore/pages/store-list?id=".concat(e,"&title=").concat(n);this.$util.goUrl({url:a})}})};e.default=f}).call(this,n("df3c")["default"])},"9ff4":function(t,e,n){"use strict";n.r(e);var a=n("7016"),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a}},[["037b","common/runtime","common/vendor"]]]);