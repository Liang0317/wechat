(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/technician"],{"079a":function(e,t,n){"use strict";(function(e,t){var i=n("47a9");n("65e9");i(n("3240"));var a=i(n("127f"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"127f":function(e,t,n){"use strict";n.r(t);var i=n("ffd5"),a=n("c603");for(var c in a)["default"].indexOf(c)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(c);n("e4b2");var o=n("828b"),r=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);t["default"]=r.exports},"1bfc":function(e,t,n){"use strict";(function(e){var i=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n("7eb4")),c=i(n("34cf")),o=i(n("7ca3")),r=i(n("ee10")),u=n("8f59"),s=i(n("56ce"));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={components:{tabbar:function(){n.e("components/tabbar").then(function(){return resolve(n("a1b6"))}.bind(null,n)).catch(n.oe)},technicianListItem:function(){n.e("components/technician-list-item").then(function(){return resolve(n("7d48"))}.bind(null,n)).catch(n.oe)},technicianListPopup:function(){n.e("components/technician-list-popup").then(function(){return resolve(n("ff93"))}.bind(null,n)).catch(n.oe)},openCityItem:function(){n.e("components/open-city-item").then(function(){return resolve(n("c4f2"))}.bind(null,n)).catch(n.oe)}},data:function(){return{isLoad:!1,options:{},navTitle:"",popupHeight:"",maxHeight:"37vh",loading:!0,lockTap:!1}},computed:(0,u.mapState)({pageActive:function(e){return e.technician.pageActive},haveOperItem:function(e){return e.technician.haveOperItem},cityId:function(e){return e.technician.cityId},cityIndex:function(e){return e.technician.cityIndex},cityList:function(e){return e.technician.cityList},activeIndex:function(e){return e.technician.activeIndex},tabList:function(e){return e.technician.tabList},sexList:function(e){return e.technician.sexList},serviceCateList:function(e){return e.technician.serviceCateList},serviceTypeList:function(e){return e.technician.serviceTypeList},check:function(e){return e.technician.check},param:function(e){return e.technician.param},list:function(e){return e.technician.list},primaryColor:function(e){return e.config.configInfo.primaryColor},subColor:function(e){return e.config.configInfo.subColor},configInfo:function(e){return e.config.configInfo},loginType:function(e){return e.user.loginType},userInfo:function(e){return e.user.userInfo},location:function(e){return e.user.location},locaRefuse:function(e){return e.user.locaRefuse},changeAddr:function(e){return e.user.changeAddr},isGzhLogin:function(e){return e.user.isGzhLogin},haveShieldOper:function(e){return e.user.haveShieldOper},useChooseLocation:function(e){return e.user.useChooseLocation},userCoachStatus:function(e){return e.user.userCoachStatus},changeOnAddr:function(e){return e.user.changeOnAddr},noChangeLoca:function(e){return e.user.noChangeLoca}}),onLoad:function(e){var t=this;return(0,r.default)(a.default.mark((function n(){var i,c,o,r,u,s,l,d,f,h,p,g,v,m,y,_,I,x,k,L;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(console.log("====onLoad technician"),t.options=e,i=e.pid,c=void 0===i?0:i,o=e.city_id,r=void 0===o?0:o,u=e.coach_id,s=void 0===u?0:u,l=e.coach_name,d=void 0===l?"":l,f=t.$util.deepCopy(t.param),(f.coach_id&&!s||f.coach_name&&!d)&&t.updateTechnicianItem({key:"pageActive",val:!1}),f.coach_id=s,f.coach_name=d,t.updateTechnicianItem({key:"param",val:f}),s&&t.updateTechnicianItem({key:"cityId",val:r}),h=t.list.data,p=void 0===h?[]:h,g=0==p.length||p[0].city_id!=t.cityId,v=t.configInfo,m=v.realtime_location,y=void 0===m?0:m,_=v.tabBar,I=_.findIndex((function(e){return 2==e.id})),x=-1==I?t.$t("action.attendantName"):_[I].name,t.navTitle=x,k=t.pageActive,L=t.changeAddr,!k||y||L||s&&c||g){n.next=21;break}return t.isLoad=!0,t.loading=!1,t.$util.hideAll(),n.abrupt("return");case 21:return n.next=23,t.initIndex();case 23:case"end":return n.stop()}}),n)})))()},onShow:function(){var e=this;return(0,r.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("====onShow technician"),e.useChooseLocation&&e.updateUserItem({key:"useChooseLocation",val:!1}),(2==e.haveShieldOper||e.haveOperItem)&&(e.initIndex(),e.updateUserItem({key:"haveShieldOper",val:0}),e.updateTechnicianItem({key:"haveOperItem",val:!1})),!e.location.lat&&e.locaRefuse&&e.toResetUtilLoca();case 4:case"end":return t.stop()}}),t)})))()},onPullDownRefresh:function(){e.showNavigationBarLoading(),this.updateUserItem({key:"changeAddr",val:!1}),this.initRefresh(),e.stopPullDownRefresh()},onReachBottom:function(){this.list.current_page>=this.list.last_page||this.loading||(this.loading=!0,this.getList(this.param.page+1))},onShareAppMessage:function(e){var t=this.userInfo.id,n=void 0===t?0:t,i="/pages/technician?pid=".concat(n);return this.$util.log(i),{title:"",imageUrl:"",path:i}},watch:{locaRefuse:function(e,t){e||this.toResetUtilLoca()},changeOnAddr:function(e,t){var n=this.noChangeLoca,i=n.noloca,a=n.refresh;e&&i&&this.initUtilLocaData(a)},noChangeLoca:function(e,t){var n=this;setTimeout((function(){var e=n.changeOnAddr,t=e.lat,i=e.lng,a=e.unix,c=void 0===a?0:a,o=n.noChangeLoca,r=o.noloca,u=o.refresh,s=n.$util.DateToUnix(n.$util.formatTime(new Date,"YY-M-D h:m:s"));r&&(!t&&!i||!c||c&&s-c>=1)&&n.getUtilLocation(u)}),800)}},methods:d(d(d({},(0,u.mapActions)(["getConfigInfo","getUserInfo","getServiceCate","getCityList","getServiceCoachList"])),(0,u.mapMutations)(["updateUserItem","updateServiceItem","updateTechnicianItem","updateMapItem","updateDynamicItem","updateShopstoreItem"])),{},{initIndex:function(){var e=arguments,t=this;return(0,r.default)(a.default.mark((function n(){var i,c,o,r,u;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.length>0&&void 0!==e[0]&&e[0],c=t.options.pid,o=void 0===c?0:c,t.isGzhLogin,r=t.userInfo.id,u=void 0===r?0:r,!o||u){n.next=7;break}return n.next=7,t.getUserInfo();case 7:if(t.configInfo.id&&t.configInfo.hasOwnProperty("free_fare_bear")&&!i){n.next=10;break}return n.next=10,t.getConfigInfo();case 10:return n.next=12,t.getServiceCate();case 12:return n.next=14,t.getList(1,!0);case 14:t.updateTechnicianItem({key:"pageActive",val:!0});case 15:case"end":return n.stop()}}),n)})))()},initRefresh:function(){var e=this;return(0,r.default)(a.default.mark((function t(){var n,i,c;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.param.page=1,t.next=3,e.initIndex(!0);case 3:n=e.configInfo.tabBar,i=n.findIndex((function(e){return 2==e.id})),c=-1==i?e.$t("action.attendantName"):n[i].name,e.navTitle=c;case 7:case"end":return t.stop()}}),t)})))()},toResetUtilLoca:function(){return(0,r.default)(a.default.mark((function e(){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},toOpenLocation:function(){var e=this;return(0,r.default)(a.default.mark((function t(){var n;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.$refs.user_privacy.check(),!n){t.next=4;break}return e.$refs.user_privacy.open(),t.abrupt("return");case 4:return t.next=6,e.$util.checkAuth({type:"userLocation",checkApp:!0});case 6:e.initIndex();case 7:case"end":return t.stop()}}),t)})))()},toAppShare:function(){var e=this,t=this.userInfo.id,n=void 0===t?0:t,i=this.$t("action.attendantName"),a=s.default.siteroot,c=a.split("/index.php")[0],o="".concat(c,"/h5/#/pages/technician?pid=").concat(n);this.$jweixin.wxReady((function(){e.$jweixin.showOptionMenu(),e.$jweixin.shareAppMessage(i,"",o,""),e.$jweixin.shareTimelineMessage(i,o,"")}))},initFixHeight:function(e){this.popupHeight=e},pickerChange:function(e,t){var n=e.target.value;this.updateTechnicianItem({key:"cityIndex",val:n}),this.updateTechnicianItem({key:"cityId",val:this.cityList[n].id}),this.getList(1)},toSearch:function(e){var t=this.$util.deepCopy(this.param);t.coach_id="",t.coach_name=e,this.updateTechnicianItem({key:"param",val:t}),this.getList(1)},toChooseLocation:function(){var e=this;return(0,r.default)(a.default.mark((function t(){var n;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.$refs.user_privacy.check(),!n){t.next=4;break}return e.$refs.user_privacy.open(),t.abrupt("return");case 4:return e.updateUserItem({key:"useChooseLocation",val:!0}),t.next=7,e.$util.checkAuth({type:"userLocation"});case 7:e.initChooseLoca();case 8:case"end":return t.stop()}}),t)})))()},initChooseLoca:function(){var t=arguments,n=this;return(0,r.default)(a.default.mark((function i(){var o,r,u,s,l,d,f,h,p,g,v,m,y,_,I,x,k;return a.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return o=t.length>0&&void 0!==t[0]?t[0]:{},i.next=3,e.chooseLocation(o);case 3:if(r=i.sent,u=(0,c.default)(r,2),s=u[0],l=u[1],d=s?{name:"",address:"",latitude:"",longitude:""}:l,f=d.name,h=void 0===f?"":f,p=d.address,g=void 0===p?"":p,v=d.latitude,m=void 0===v?"":v,y=d.longitude,_=void 0===y?"":y,g=g||h,I={lat:m,lng:_,address:g,province:"",city:"",district:""},n.updateUserItem({key:"useChooseLocation",val:!1}),m){i.next=13;break}return i.abrupt("return");case 13:return n.updateUserItem({key:"location",val:I}),n.updateUserItem({key:"changeAddr",val:!0}),n.$refs.open_city_item&&(n.$refs.open_city_item.city=""),x=n.param.coach_id,k=void 0===x?0:x,i.next=19,n.getCityList({lat:m,lng:_,change:k?0:1});case 19:return i.next=21,n.getList(1);case 21:case"end":return i.stop()}}),i)})))()},getList:function(){var e=arguments,t=this;return(0,r.default)(a.default.mark((function n(){var i,c,o,r,u,s,l,d,f,h,p,g,v,m,y,_,I,x,k,L,b;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.length>0&&void 0!==e[0]?e[0]:0,c=e.length>1&&void 0!==e[1]&&e[1],i&&(o=t.$util.deepCopy(t.param),o.page=i,t.updateTechnicianItem({key:"param",val:o})),t.loading=!0,r=t.location,t.locaRefuse,u=t.changeAddr,s=t.configInfo.realtime_location,l=void 0===s?0:s,d=t.userCoachStatus,f=d.status,h=d.coach_position,1!=t.param.page){n.next=32;break}if(!(!r.lat||r.lat&&"暂未获取到位置信息"==r.address||c&&l&&!u)){n.next=30;break}if(p=t.$refs.user_privacy.check(),!p){n.next=16;break}return t.$refs.user_privacy.open(),t.isLoad=!0,t.loading=!1,t.$util.hideAll(),n.abrupt("return");case 16:if(2!=f||!h){n.next=27;break}if(g=t.changeOnAddr,v=g.lat,m=void 0===v?0:v,y=g.lng,_=void 0===y?0:y,I=g.unix,x=void 0===I?0:I,k=t.$util.DateToUnix(t.$util.formatTime(new Date,"YY-M-D h:m:s")),L=!(m&&_&&x&&k-x<3),L||(b=Object.assign({},t.location,{lat:m,lng:_,is_util_loca:1}),t.updateUserItem({key:"location",val:b})),t.updateUserItem({key:"noChangeLoca",val:{noloca:L,refresh:c}}),!t.noChangeLoca.noloca){n.next=24;break}return n.abrupt("return");case 24:t.initUtilLocaData(c),n.next=28;break;case 27:t.getUtilLocation(c);case 28:n.next=31;break;case 30:t.initUtilLocaData(c);case 31:return n.abrupt("return");case 32:t.initUtilLocaData(c);case 33:case"end":return n.stop()}}),n)})))()},getUtilLocation:function(e){var t=this;return(0,r.default)(a.default.mark((function n(){var i,c,o,r,u,s;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$util.getLocation();case 2:i=n.sent,c=i.lat,o=void 0===c?0:c,r=i.lng,u=void 0===r?0:r,s=Object.assign({},t.location,{lat:o,lng:u,is_util_loca:1}),t.updateUserItem({key:"location",val:s}),t.initUtilLocaData(e);case 10:case"end":return n.stop()}}),n)})))()},initUtilLocaData:function(e){var t=this;return(0,r.default)(a.default.mark((function n(){var i,c,o,r,u,s,l,d,f,h,p,g,v,m,y,_,I,x,k,L,b,w,C,$;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.updateUserItem({key:"noChangeLoca",val:{noloca:!1}}),i=t.changeAddr,c=t.configInfo.realtime_location,o=void 0===c?0:c,r=t.location,u=r.lng,s=void 0===u?0:u,l=r.lat,d=void 0===l?0:l,f=r.is_util_loca,h=void 0===f?0:f,!e){n.next=8;break}return p=t.param.coach_id,g=void 0===p?0:p,n.next=8,t.getCityList({lng:s,lat:d,change:g?0:1});case 8:if(t.list,v=t.activeIndex,m=t.tabList,y=t.cityList,_=t.cityIndex,I=t.cityId,x=t.$util.deepCopy(t.param),k=y.findIndex((function(e){return e.id==I})),-1!=k){n.next=20;break}if(1!=x.page||!(h||o&&!i)){n.next=15;break}return n.next=15,t.$util.getMapInfo(!0,{},i);case 15:return t.$refs.open_city_item&&t.$refs.open_city_item.initIndex(),t.loading=!1,t.$util.hideAll(),t.updateTechnicianItem({key:"list",val:{data:[],last_page:1,current_page:1}}),n.abrupt("return");case 20:return I=-1==k?0:I,_=-1==k?0:k,t.updateTechnicianItem({key:"cityIndex",val:_}),t.updateTechnicianItem({key:"cityId",val:I}),L=t.configInfo,b=L.coach_format,w=void 0===b?1:b,C=L.coach_filter_show,$=void 0===C?0:C,x=Object.assign({},x,t.check,{lat:d,lng:s,city_id:I}),1==w&&(x.type=m[v].id),$?(-1===x.sex&&delete x.sex,0===x.recommend&&delete x.recommend,0===x.cate_id&&delete x.cate_id,0===x.service_type&&delete x.service_type):(delete x.sex,delete x.cate_id,delete x.recommend,delete x.free_fare,delete x.service_type,delete x.store_name),n.next=30,t.getServiceCoachList(x);case 30:t.loading=!1,t.$util.hideAll(),1==x.page&&(h||o&&!i)&&t.$util.getMapInfo(!0,{},i);case 33:case"end":return n.stop()}}),n)})))()},handerTabChange:function(t){this.updateTechnicianItem({key:"activeIndex",val:t}),this.$util.showLoading(),e.pageScrollTo({scrollTop:0}),this.getList(1)},toChangeItem:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;"cate_id"===e&&this.check[e]==t&&(t=0);var i=Object.assign({},this.check,(0,o.default)({},e,t));this.updateTechnicianItem({key:"check",val:i}),n&&this.toConfirm(0)},toPopup:function(e,t){this.$refs[e][t](),this.popupTap="open"===t},toChangePopupShow:function(e){var t=e.show;t||this.updateTechnicianItem({key:"check",val:this.$util.pick(this.param,["sex","cate_id","recommend","service_type","store_name","free_fare"])})},toReset:function(){this.updateTechnicianItem({key:"check",val:{sex:-1,cate_id:0,recommend:0,free_fare:0,service_type:0,store_name:""}}),this.toConfirm()},toConfirm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Object.assign({},this.param,this.check);this.updateTechnicianItem({key:"param",val:t}),this.getList(1),e&&(this.$refs.search_item.close(),this.popupTap=!1)},toShowPopup:function(e,t){var n=this;return(0,r.default)(a.default.mark((function i(){return a.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:n.$refs.technician_list_popup.toShowPopup(n.list.data[e],t);case 1:case"end":return i.stop()}}),i)})))()},toCollect:function(e){var t=this;return(0,r.default)(a.default.mark((function n(){var i,c,o,r,u;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=t.list.data[e],c=i.id,o=i.is_collect,r=i.collect_num,u=o?"delCollect":"addCollect",n.next=4,t.$api.mine[u]({coach_id:c});case 4:t.$util.showToast({title:o?"取消成功":"收藏成功"}),t.list.data[e].is_collect=1==o?0:1,t.list.data[e].collect_num=1==o?r-1:r+1;case 7:case"end":return n.stop()}}),n)})))()}})};t.default=f}).call(this,n("df3c")["default"])},c603:function(e,t,n){"use strict";n.r(t);var i=n("1bfc"),a=n.n(i);for(var c in i)["default"].indexOf(c)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(c);t["default"]=a.a},e4b2:function(e,t,n){"use strict";var i=n("f49c"),a=n.n(i);a.a},f49c:function(e,t,n){},ffd5:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var i=function(){var e=this,t=e.$createElement,n=(e._self._c,e.cityList&&e.cityList.length>0),i=n&&-1!==e.cityIndex?e.cityList[e.cityIndex].title.length:null,a=n&&-1!==e.cityIndex&&i>3?e.cityList[e.cityIndex].title.substring(0,3):null,c=e.$t("action.attendantName"),o=e.configInfo.coach_filter_show&&e.configInfo.plugAuth.recommend?e.$t("action.attendantName"):null,r=e.pageActive&&e.list.data&&e.list.data.length>0,u=r?[2,3].includes(e.configInfo.coach_list_format):null,s=r?e.__map(e.list.data,(function(t,n){var i=e.__get_orig(t),a=1===e.configInfo.coach_list_format&&0!=n||[2,3].includes(e.configInfo.coach_list_format)&&n>1,c=[2,3].includes(e.configInfo.coach_list_format)&&n%2==0;return{$orig:i,g5:a,g6:c}})):null,l=e.loading?e.list.current_page>=e.list.last_page&&e.list.data.length>0&&e.location.lng:null,d=!e.loading&&e.list.data.length<=0&&1==e.list.current_page,f=d&&e.location.lat&&e.location.lng&&-1!==e.cityIndex?e.$t("action.attendantName"):null,h=!d||e.location.lat||e.location.lng?null:e.$t("action.attendantName"),p=!e.loading&&e.list.data.length<=0&&1==e.list.current_page&&-1===e.cityIndex&&e.location.lat&&e.location.lng,g=e.$t("action.attendantName"),v=e.serviceCateList&&e.serviceCateList.length>0;e._isMounted||(e.e0=function(t){return t.stopPropagation(),e.$refs.choose_city_item.close()}),e.$mp.data=Object.assign({},{$root:{g0:n,g1:i,g2:a,m0:c,m1:o,g3:r,g4:u,l0:s,g7:l,g8:d,m2:f,m3:h,g9:p,m4:g,g10:v}})},a=[]}},[["079a","common/runtime","common/vendor"]]]);