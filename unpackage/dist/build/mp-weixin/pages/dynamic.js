(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/dynamic"],{"04ae":function(e,t,n){"use strict";n.r(t);var a=n("e083"),i=n("a4ef");for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);n("d2b5");var o=n("828b"),c=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);t["default"]=c.exports},4792:function(e,t,n){"use strict";(function(e,t){var a=n("47a9");n("65e9");a(n("3240"));var i=a(n("04ae"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(i.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},7217:function(e,t,n){"use strict";(function(e){var a=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("7eb4")),r=a(n("7ca3")),o=a(n("ee10")),c=n("8f59"),u=a(n("56ce"));function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={components:{tabbar:function(){n.e("components/tabbar").then(function(){return resolve(n("a1b6"))}.bind(null,n)).catch(n.oe)},wfallsFlow:function(){n.e("components/wfalls-flow").then(function(){return resolve(n("521f"))}.bind(null,n)).catch(n.oe)}},data:function(){return{isLoad:!1,options:{},navTitle:"",loading:!0,lockTap:!1}},computed:(0,c.mapState)({pageActive:function(e){return e.dynamic.pageActive},activeIndex:function(e){return e.dynamic.activeIndex},tabList:function(e){return e.dynamic.tabList},param:function(e){return e.dynamic.param},list:function(e){return e.dynamic.list},coach_status:function(e){return e.dynamic.coach_status},primaryColor:function(e){return e.config.configInfo.primaryColor},subColor:function(e){return e.config.configInfo.subColor},configInfo:function(e){return e.config.configInfo},autograph:function(e){return e.user.autograph},userInfo:function(e){return e.user.userInfo},location:function(e){return e.user.location},locaRefuse:function(e){return e.user.locaRefuse},isGzhLogin:function(e){return e.user.isGzhLogin},haveShieldOper:function(e){return e.user.haveShieldOper},userCoachStatus:function(e){return e.user.userCoachStatus},changeOnAddr:function(e){return e.user.changeOnAddr},noChangeLoca:function(e){return e.user.noChangeLoca}}),onLoad:function(e){var t=this;return(0,o.default)(i.default.mark((function n(){var a,r,o;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.options=e,t.$util.showLoading(),n.next=4,t.initIndex();case 4:t.updateDynamicItem({key:"pageActive",val:!0}),a=t.configInfo.tabBar,r=a.findIndex((function(e){return 3==e.id})),o=-1==r?"动态":a[r].name,t.navTitle=o;case 9:case"end":return n.stop()}}),n)})))()},onShow:function(){var e=this;return(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!=e.haveShieldOper){t.next=4;break}return t.next=3,e.initIndex();case 3:e.updateUserItem({key:"haveShieldOper",val:0});case 4:!e.location.lat&&e.locaRefuse&&e.toResetUtilLoca();case 5:case"end":return t.stop()}}),t)})))()},onPullDownRefresh:function(){var t=this;return(0,o.default)(i.default.mark((function n(){return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.showNavigationBarLoading(),n.next=3,t.initRefresh();case 3:e.stopPullDownRefresh();case 4:case"end":return n.stop()}}),n)})))()},onReachBottom:function(){var e=this;return(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.list.current_page>=e.list.last_page||e.loading)){t.next=2;break}return t.abrupt("return");case 2:return e.param.page=e.param.page+1,e.loading=!0,t.next=6,e.getList();case 6:setTimeout((function(){e.$refs.dynamic_wfalls.handleViewRender()}),0);case 7:case"end":return t.stop()}}),t)})))()},onShareAppMessage:function(e){var t=this.userInfo.id,n=void 0===t?0:t,a="/pages/dynamic?pid=".concat(n);return this.$util.log(a),{title:"",imageUrl:"",path:a}},watch:{locaRefuse:function(e,t){e||this.toResetUtilLoca()},changeOnAddr:function(e,t){var n=this.noChangeLoca.noloca;e&&n&&this.initUtilLocaData()},noChangeLoca:function(e,t){var n=this;setTimeout((function(){var e=n.changeOnAddr,t=e.lat,a=e.lng,i=e.unix,r=void 0===i?0:i,o=n.noChangeLoca.noloca,c=n.$util.DateToUnix(n.$util.formatTime(new Date,"YY-M-D h:m:s"));o&&(!t&&!a||!r||r&&c-r>=1)&&n.getUtilLocation()}),800)}},methods:l(l(l({},(0,c.mapActions)(["getConfigInfo","getUserInfo","getDynamicIndex","getDynamicList"])),(0,c.mapMutations)(["updateUserItem","updateServiceItem","updateTechnicianItem","updateMapItem","updateDynamicItem","updateShopstoreItem"])),{},{initIndex:function(){var e=arguments,t=this;return(0,o.default)(i.default.mark((function n(){var a,r,o,c,u,s,l;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.length>0&&void 0!==e[0]&&e[0],r=t.options.pid,o=void 0===r?0:r,a||!t.pageActive||o){n.next=7;break}return t.isLoad=!0,t.loading=!1,t.$util.hideAll(),n.abrupt("return");case 7:if(t.isGzhLogin,c=t.userInfo.id,u=void 0===c?0:c,!o||u){n.next=12;break}return n.next=12,t.getUserInfo();case 12:if(t.configInfo.id&&!a&&(!t.configInfo.id||t.configInfo.plugAuth.hasOwnProperty("dynamic"))){n.next=15;break}return n.next=15,t.getConfigInfo();case 15:if(s=t.configInfo.plugAuth.dynamic,l=void 0!==s&&s,l){n.next=21;break}return t.isLoad=!0,t.loading=!1,t.$util.hideAll(),n.abrupt("return");case 21:return n.next=23,Promise.all([t.getDynamicIndex(),t.getList(1)]);case 23:case"end":return n.stop()}}),n)})))()},initRefresh:function(){var e=this;return(0,o.default)(i.default.mark((function t(){var n,a,r;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.initIndex(!0);case 2:n=e.configInfo.tabBar,a=n.findIndex((function(e){return 3==e.id})),r=-1==a?"动态":n[a].name,e.navTitle=r;case 6:case"end":return t.stop()}}),t)})))()},toResetUtilLoca:function(){return(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},toOpenLocation:function(){var e=this;return(0,o.default)(i.default.mark((function t(){var n;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.$refs.user_privacy.check(),!n){t.next=4;break}return e.$refs.user_privacy.open(),t.abrupt("return");case 4:return t.next=6,e.$util.checkAuth({type:"userLocation",checkApp:!0});case 6:e.initRefresh();case 7:case"end":return t.stop()}}),t)})))()},toAppShare:function(){var e=this,t=this.userInfo.id,n=void 0===t?0:t,a=this.detail.title,i=u.default.siteroot,r=i.split("/index.php")[0],o="".concat(r,"/h5/#/pages/dynamic?pid=").concat(n);this.$jweixin.wxReady((function(){e.$jweixin.showOptionMenu(),e.$jweixin.shareAppMessage(a,"",o,""),e.$jweixin.shareTimelineMessage(a,o,"")}))},handerTabChange:function(t){var n=this;return(0,o.default)(i.default.mark((function a(){return i.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n.updateDynamicItem({key:"activeIndex",val:t}),e.pageScrollTo({scrollTop:0}),a.next=4,n.getList(1);case 4:if(1!=t){a.next=7;break}return a.next=7,n.getDynamicIndex();case 7:case"end":return a.stop()}}),a)})))()},toSearch:function(e){this.param.coach_name=e,this.getList(1)},getList:function(e){var t=this;return(0,o.default)(i.default.mark((function n(){var a,r,o,c,u,s,l,f,d,p,h,g,v,m,w;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e&&(t.param.page=1,t.list.data=[]),a=t.location,t.locaRefuse,r=t.userCoachStatus,o=r.status,c=r.coach_position,1!=t.param.page||a.lat&&(!a.lat||"暂未获取到位置信息"!=a.address)){n.next=25;break}if(u=t.$refs.user_privacy.check(),!u){n.next=11;break}return t.$refs.user_privacy.open(),t.isLoad=!0,t.loading=!1,t.$util.hideAll(),n.abrupt("return");case 11:if(2!=o||!c){n.next=22;break}if(s=t.changeOnAddr,l=s.lat,f=void 0===l?0:l,d=s.lng,p=void 0===d?0:d,h=s.unix,g=void 0===h?0:h,v=t.$util.DateToUnix(t.$util.formatTime(new Date,"YY-M-D h:m:s")),m=!(f&&p&&g&&v-g<3),m||(w=Object.assign({},t.location,{lat:f,lng:p,is_util_loca:1}),t.updateUserItem({key:"location",val:w})),t.updateUserItem({key:"noChangeLoca",val:{noloca:m}}),!t.noChangeLoca.noloca){n.next=19;break}return n.abrupt("return");case 19:t.initUtilLocaData(),n.next=23;break;case 22:t.getUtilLocation();case 23:return t.updateMapItem({key:"pageActive",val:!1}),n.abrupt("return");case 25:t.initUtilLocaData();case 26:case"end":return n.stop()}}),n)})))()},getUtilLocation:function(){var e=this;return(0,o.default)(i.default.mark((function t(){var n,a,r,o,c,u;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$util.getLocation();case 2:n=t.sent,a=n.lat,r=void 0===a?0:a,o=n.lng,c=void 0===o?0:o,u=Object.assign({},e.location,{lat:r,lng:c,is_util_loca:1}),e.updateUserItem({key:"location",val:u}),e.initUtilLocaData();case 10:case"end":return t.stop()}}),t)})))()},initUtilLocaData:function(){var e=this;return(0,o.default)(i.default.mark((function t(){var n,a,r,o,c,u,s,l;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.updateUserItem({key:"noChangeLoca",val:{noloca:!1}}),n=e.location,a=n.lat,r=void 0===a?0:a,o=n.lng,c=void 0===o?0:o,u=n.is_util_loca,s=void 0===u?0:u,e.list,l=Object.assign({},e.param,{lat:r,lng:c}),t.next=6,e.getDynamicList(l);case 6:e.isLoad=!0,e.loading=!1,e.$util.hideAll(),1==l.page&&r&&c&&s&&e.$util.getMapInfo();case 10:case"end":return t.stop()}}),t)})))()},toAddDynamic:function(e){this.$refs.show_item.close(),this.$util.goUrl({url:"/dynamic/pages/technician/edit?type=".concat(e)})}})};t.default=f}).call(this,n("df3c")["default"])},a4ef:function(e,t,n){"use strict";n.r(t);var a=n("7217"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(r);t["default"]=i.a},d2b5:function(e,t,n){"use strict";var a=n("f024"),i=n.n(a);i.a},e083:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement,n=(e._self._c,e.isLoad&&e.configInfo.plugAuth.dynamic?e.$t("action.attendantName"):null),a=e.isLoad&&e.configInfo.plugAuth.dynamic?e.list.data.length:null,i=e.isLoad&&e.configInfo.plugAuth.dynamic&&e.loading?e.list.current_page>=e.list.last_page&&e.list.data.length>0:null,r=e.isLoad&&e.configInfo.plugAuth.dynamic?!e.loading&&e.list.data.length<=0&&1==e.list.current_page:null;e._isMounted||(e.e0=function(t){return t.stopPropagation(),e.$refs.show_item.open()},e.e1=function(t){return t.stopPropagation(),e.$refs.show_item.close()}),e.$mp.data=Object.assign({},{$root:{m0:n,g0:a,g1:i,g2:r}})},i=[]},f024:function(e,t,n){}},[["4792","common/runtime","common/vendor"]]]);