(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/service"],{"106e":function(e,t,n){},"3dd9":function(e,t,n){"use strict";var i=n("106e"),a=n.n(i);a.a},5164:function(e,t,n){"use strict";n.r(t);var i=n("cca1"),a=n("68c0");for(var r in a)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(r);n("3dd9");var o=n("828b"),c=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);t["default"]=c.exports},"68c0":function(e,t,n){"use strict";n.r(t);var i=n("90f9"),a=n.n(i);for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=a.a},8505:function(e,t,n){"use strict";(function(e,t){var i=n("47a9");n("65e9");i(n("3240"));var a=i(n("5164"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"90f9":function(e,t,n){"use strict";(function(e){var i=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n("7eb4")),r=i(n("7ca3")),o=i(n("ee10")),c=n("8f59"),u=i(n("56ce"));function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={components:{serviceListItem:function(){n.e("components/service-list-item").then(function(){return resolve(n("f22f"))}.bind(null,n)).catch(n.oe)},openMiniProgram:function(){n.e("components/open-mini-program").then(function(){return resolve(n("f884"))}.bind(null,n)).catch(n.oe)},tabbar:function(){n.e("components/tabbar").then(function(){return resolve(n("a1b6"))}.bind(null,n)).catch(n.oe)}},data:function(){return{couponList:[],coupon_discount:0,isLoad:!1,options:{},loading:!0,lockTap:!1,openMiniForm:{}}},computed:(0,c.mapState)({pageActive:function(e){return e.service.pageActive},activeIndex:function(e){return e.service.activeIndex},tabList:function(e){return e.service.tabList},param:function(e){return e.service.param},list:function(e){return e.service.list},banner:function(e){return e.service.banner},service_cate:function(e){return e.service.service_cate},recommend_list:function(e){return e.service.recommend_list},recommend_style:function(e){return e.service.recommend_style},have_coupon:function(e){return e.service.have_coupon},primaryColor:function(e){return e.config.configInfo.primaryColor},subColor:function(e){return e.config.configInfo.subColor},configInfo:function(e){return e.config.configInfo},autograph:function(e){return e.user.autograph},userInfo:function(e){return e.user.userInfo},location:function(e){return e.user.location},locaRefuse:function(e){return e.user.locaRefuse},changeAddr:function(e){return e.user.changeAddr},isGzhLogin:function(e){return e.user.isGzhLogin},haveShieldOper:function(e){return e.user.haveShieldOper},userCoachStatus:function(e){return e.user.userCoachStatus},useChooseLocation:function(e){return e.user.useChooseLocation},changeOnAddr:function(e){return e.user.changeOnAddr},noChangeLoca:function(e){return e.user.noChangeLoca},scanRecordId:function(e){return e.user.scanRecordId}}),onLoad:function(t){var n=this;return(0,o.default)(a.default.mark((function i(){var r,o,c,u,s,l,d;return a.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(r=t,o=r.channel_id,c=void 0===o?0:o,c&&n.addScanRecord({type:1,qr_id:c}),!c){i.next=8;break}return i.next=5,n.updateCommonOptions(t);case 5:i.t0=i.sent,i.next=9;break;case 8:i.t0=t;case 9:return t=i.t0,n.options=t,u=n.configInfo.realtime_location,s=void 0===u?0:u,l=n.pageActive,d=n.changeAddr,l||n.$util.showLoading(),e.onNetworkStatusChange((function(e){var t=e.isConnected;t&&(!l||l&&(s||d))&&n.initIndex()})),i.next=17,n.initIndex();case 17:case"end":return i.stop()}}),i)})))()},onShow:function(){var e=this;return(0,o.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:2==e.haveShieldOper&&(e.initIndex(),e.updateUserItem({key:"haveShieldOper",val:0})),e.pageActive&&e.userInfo.id&&e.getCouponList(),!e.location.lat&&e.locaRefuse&&e.toResetUtilLoca();case 3:case"end":return t.stop()}}),t)})))()},onPullDownRefresh:function(){e.showNavigationBarLoading(),this.updateUserItem({key:"changeAddr",val:!1}),this.initRefresh(),e.stopPullDownRefresh()},onReachBottom:function(){this.list.current_page>=this.list.last_page||this.loading||(this.loading=!0,this.getList(this.param.page+1))},onShareAppMessage:function(e){var t=this.userInfo.id,n=void 0===t?0:t,i="/pages/service?pid=".concat(n);return this.$util.log(i),{title:"",imageUrl:"",path:i}},watch:{locaRefuse:function(e,t){e||this.toResetUtilLoca()},changeOnAddr:function(e,t){var n=this.noChangeLoca.noloca;e&&n&&this.initUtilLocaData()},noChangeLoca:function(e,t){var n=this;setTimeout((function(){var e=n.changeOnAddr,t=e.lat,i=e.lng,a=e.unix,r=void 0===a?0:a,o=n.noChangeLoca.noloca,c=n.$util.DateToUnix(n.$util.formatTime(new Date,"YY-M-D h:m:s"));o&&(!t&&!i||!r||r&&c-r>=1)&&n.getUtilLocation()}),800)}},methods:l(l(l({},(0,c.mapActions)(["getConfigInfo","getUserInfo","updateCommonOptions","addScanRecord","updateScanRecord","getServiceIndex","getRecommendList","getServiceList"])),(0,c.mapMutations)(["updateUserItem","updateServiceItem","updateTechnicianItem","updateMapItem","updateDynamicItem","updateShopstoreItem"])),{},{initIndex:function(){var e=arguments,t=this;return(0,o.default)(a.default.mark((function n(){var i,r,o,c,u,s,l,d,f,p,h,g,v,m,b,_,L,x,w,I,k,y,$,C,O,A,U,S,R,j,T;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.length>0&&void 0!==e[0]&&e[0],t.configInfo.id&&!i){n.next=4;break}return n.next=4,t.getConfigInfo();case 4:if(r=t.options,o=r.pid,c=void 0===o?0:o,u=r.channel_id,s=void 0===u?0:u,l=t.configInfo.realtime_location,d=void 0===l?0:l,i||!t.pageActive||d||t.changeAddr||c&&s){n.next=11;break}return t.isLoad=!0,t.loading=!1,t.$util.hideAll(),n.abrupt("return");case 11:return n.next=13,t.toBindChannel();case 13:return n.next=15,t.getServiceIndex();case 15:if(t.isLoad=!0,f=t.location,t.locaRefuse,p=t.changeAddr,h=t.configInfo,g=h.plugAuth,v=void 0===g?{}:g,m=h.realtime_location,b=void 0===m?0:m,_=v.recommend,L=void 0!==_&&_,x=t.userCoachStatus,w=x.status,I=x.coach_position,!(b&&!p||!b&&L&&!f.lat)){n.next=40;break}if(k=t.$refs.user_privacy.check(),!k){n.next=27;break}return t.$refs.user_privacy.open(),t.loading=!1,t.$util.hideAll(),n.abrupt("return");case 27:if(2!=w||!I){n.next=38;break}if(y=t.changeOnAddr,$=y.lat,C=void 0===$?0:$,O=y.lng,A=void 0===O?0:O,U=y.unix,S=void 0===U?0:U,R=t.$util.DateToUnix(t.$util.formatTime(new Date,"YY-M-D h:m:s")),j=!(C&&A&&S&&R-S<3),j||(T=Object.assign({},t.location,{lat:C,lng:A,is_util_loca:1}),t.updateUserItem({key:"location",val:T})),t.updateUserItem({key:"noChangeLoca",val:{noloca:j}}),!t.noChangeLoca.noloca){n.next=35;break}return n.abrupt("return");case 35:t.initUtilLocaData(),n.next=39;break;case 38:t.getUtilLocation();case 39:return n.abrupt("return");case 40:t.initUtilLocaData();case 41:case"end":return n.stop()}}),n)})))()},getUtilLocation:function(){var e=this;return(0,o.default)(a.default.mark((function t(){var n,i,r,o,c,u;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$util.getLocation();case 2:n=t.sent,i=n.lat,r=void 0===i?0:i,o=n.lng,c=void 0===o?0:o,u=Object.assign({},e.location,{lat:r,lng:c,is_util_loca:1}),e.updateUserItem({key:"location",val:u}),e.initUtilLocaData();case 10:case"end":return t.stop()}}),t)})))()},initUtilLocaData:function(){var e=this;return(0,o.default)(a.default.mark((function t(){var n,i,r,o,c,u,s,l,d,f,p,h;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.updateUserItem({key:"noChangeLoca",val:{noloca:!1}}),n=e.location,i=n.lng,r=void 0===i?0:i,o=n.lat,c=void 0===o?0:o,e.updateServiceItem({key:"pageActive",val:!0}),e.$util.hideAll(),u=e.configInfo,s=u.plugAuth,l=void 0===s?{}:s,d=u.realtime_location,f=void 0===d?0:d,p=l.recommend,h=void 0!==p&&p,c||r||!(f||!f&&h)){t.next=13;break}return e.userInfo.id&&e.have_coupon&&e.getCouponList(),e.updateServiceItem({key:"recommend_list",val:[]}),e.updateServiceItem({key:"list",val:{data:[],last_page:1,current_page:1}}),e.loading=!1,e.$util.hideAll(),t.abrupt("return");case 13:if(!h){t.next=18;break}return t.next=16,Promise.all([e.getRecommendList({lat:c,lng:r}),e.getList(1)]);case 16:t.next=20;break;case 18:return t.next=20,e.getList(1);case 20:(f||!f&&h)&&!e.changeAddr&&e.$util.getMapInfo(),e.userInfo.id&&e.have_coupon&&e.getCouponList();case 22:case"end":return t.stop()}}),t)})))()},initRefresh:function(){this.initIndex(!0)},toResetUtilLoca:function(){return(0,o.default)(a.default.mark((function e(){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},toOpenLocation:function(){var e=this;return(0,o.default)(a.default.mark((function t(){var n;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.$refs.user_privacy.check(),!n){t.next=4;break}return e.$refs.user_privacy.open(),t.abrupt("return");case 4:return t.next=6,e.$util.checkAuth({type:"userLocation",checkApp:!0});case 6:e.initIndex();case 7:case"end":return t.stop()}}),t)})))()},getList:function(){var e=arguments,t=this;return(0,o.default)(a.default.mark((function n(){var i,r,o,c,u,s,l,d,f,p,h,g,v,m,b,_,L;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.length>0&&void 0!==e[0]?e[0]:0,r=t.configInfo.realtime_location,o=void 0===r?0:r,i&&(c=t.tabList,u=t.activeIndex,s=t.banner.service_filter,l=void 0===s||s,l||(u=0),d=c[u],f=d.sort,p=d.sign,o&&0==u&&(f="type desc"),h=0==u||1==p?"":"desc",t.updateServiceItem({key:"param",val:{page:i,sort:"".concat(f," ").concat(h)}})),t.loading=!0,t.list,g=t.location,v=g.lng,m=void 0===v?0:v,b=g.lat,_=void 0===b?0:b,_||m||!o){n.next=10;break}return t.loading=!1,t.$util.hideAll(),n.abrupt("return");case 10:return L=Object.assign({},t.param,{lat:_,lng:m}),n.next=13,t.getServiceList(L);case 13:t.loading=!1,t.$util.hideAll();case 15:case"end":return n.stop()}}),n)})))()},handerTabChange:function(t){this.updateServiceItem({key:"activeIndex",val:t});var n=this.$util.deepCopy(this.tabList),i=n[t],a=i.is_sign,r=i.sign;a&&(n[t].sign=0==r?1:0),this.updateServiceItem({key:"tabList",val:n}),this.$util.showLoading(),e.pageScrollTo({scrollTop:0}),this.getList(1)},getCouponList:function(){var e=this;return(0,o.default)(a.default.mark((function t(){var n,i,r,o,c,u,s;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.location,i=n.lat,r=n.lng,t.next=3,e.$api.service.couponList({lat:i,lng:r});case 3:o=t.sent,c=o.discount,u=void 0===c?0:c,s=o.list,e.couponList=s,e.coupon_discount=u,e.isLoad&&(1*u>0&&e.$refs.coupon_auto_item.open(),1*u==0&&s.length>0&&e.$refs.coupon_item.open()),e.loading=!1,e.$util.hideAll();case 12:case"end":return t.stop()}}),t)})))()},toAppShare:function(){var e=this,t=this.userInfo.id,n=void 0===t?0:t,i=u.default.siteroot,a=i.split("/index.php")[0],r="".concat(a,"/h5/#/pages/service?pid=").concat(n);this.$jweixin.wxReady((function(){e.$jweixin.showOptionMenu(),e.$jweixin.shareAppMessage("首页","",r,""),e.$jweixin.shareTimelineMessage("首页",r,"")}))},toBindChannel:function(){var e=this;return(0,o.default)(a.default.mark((function t(){var n,i,r,o,c,u,s,l;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.options,i=n.pid,r=void 0===i?0:i,o=n.channel_id,c=void 0===o?0:o,u=e.userInfo.id,s=void 0===u?0:u,!r&&!c||s){t.next=5;break}return t.next=5,e.getUserInfo();case 5:if(l=e.userInfo.id,!c||!l){t.next=9;break}return t.next=9,e.$api.user.bindChannel({channel_id:c});case 9:e.scanRecordId&&e.updateScanRecord();case 10:case"end":return t.stop()}}),t)})))()},goBanner:function(e){var t=e.connect_type,n=e.type_id,i=void 0===n?0:n,a=e.img,r=e.linkType,o=void 0===r?0:r,c=e.link,u=void 0===c?[]:c;if(t)switch(t){case 1:this.$util.previewImage({current:a,urls:[a]});break;case 2:this.$util.goUrl({url:"/user/pages/article?id=".concat(i)});break}else{var s=u[0].url;this.toConfirmGoUrl(s,o,a[0].url)}},goCate:function(e){var t=e.id,n=e.title,i=e.url,a=void 0===i?"":i,r=e.linkType,o=void 0===r?0:r,c=e.link,u=void 0===c?[]:c,s=e.img,l=void 0===s?[]:s;o&&(a=u[0].url),a||(a="/user/pages/service/list?id=".concat(t,"&title=").concat(n)),["/technician/pages/apply?type=1","/agent/pages/apply"].includes(a)?this.$util.toCheckLogin({url:a}):o?this.toConfirmGoUrl(a,o,l[0].url,n):this.$util.goUrl({url:a})},toConfirmGoUrl:function(e,t,n){if(["/technician/pages/apply?type=1","/agent/pages/apply"].includes(e))this.$util.toCheckLogin({url:e});else if(5!=t){var i=this.configInfo.methodObj,a=i[t];this.$util.goUrl({url:e,openType:a})}else this.$util.previewImage({current:n,urls:[n]})},userGetCoupon:function(){var e=this;return(0,o.default)(a.default.mark((function t(){var n;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=[],e.couponList.forEach((function(e){n.push(e.id)})),t.next=4,e.$api.service.userGetCoupon({coupon_id:n});case 4:t.sent,e.$util.showToast({title:"领取成功"}),setTimeout((function(){e.$util.goUrl({url:"/user/pages/coupon/list"})}),1e3),e.$refs.coupon_item.close(),e.loading=!1,e.$util.hideAll();case 10:case"end":return t.stop()}}),t)})))()},toCouponGetBtn:function(){var e=this;return(0,o.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.coupon_auto_item.close(),e.$util.goUrl({url:"/user/pages/coupon/list"});case 2:case"end":return t.stop()}}),t)})))()},toTechnician:function(e){var t=this.recommend_list[e],n=t.id,i=t.city_id,a=t.coach_name;this.updateTechnicianItem({key:"pageActive",val:!1}),this.$util.goUrl({url:"/pages/technician?coach_id=".concat(n,"&coach_name=").concat(a,"&city_id=").concat(i),openType:"reLaunch"})}})};t.default=d}).call(this,n("df3c")["default"])},cca1:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var i=function(){var e=this,t=e.$createElement,n=(e._self._c,e.isLoad?e.banner.list.length>0||e.banner.service_filter:null),i=e.isLoad&&n?e.banner.list.length:null,a=e.isLoad&&n?e.banner.list.length:null,r=e.isLoad&&n?e.banner.list.length:null,o=e.isLoad&&n?e.banner.list.length:null,c=e.isLoad&&n&&e.banner.service_filter?e.banner.list.length:null,u=e.isLoad&&n&&e.banner.service_filter?e.tabList.length:null,s=e.isLoad?e.service_cate.list.length:null,l=e.isLoad?e.recommend_list&&e.recommend_list.length>0:null,d=e.isLoad&&l?e.$t("action.attendantName"):null,f=e.isLoad&&e.loading?e.list.current_page>=e.list.last_page&&e.list.data.length>0&&e.location.lng:null,p=e.isLoad?!e.loading&&e.list.data.length<=0&&1==e.list.current_page:null;e._isMounted||(e.e0=function(t){return t.stopPropagation(),e.$util.goUrl({url:"/pages/technician",openType:"reLaunch"})},e.e1=function(t){return t.stopPropagation(),e.$refs.coupon_auto_item.close()},e.e2=function(t){return t.stopPropagation(),e.$refs.coupon_item.close()}),e.$mp.data=Object.assign({},{$root:{g0:n,g1:i,g2:a,g3:r,g4:o,g5:c,g6:u,g7:s,g8:l,m0:d,g9:f,g10:p}})},a=[]}},[["8505","common/runtime","common/vendor"]]]);