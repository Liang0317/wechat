(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/upload"],{2659:function(e,t,n){"use strict";n.r(t);var i=n("e251"),r=n("d067");for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);n("e2e6");var o=n("828b"),u=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);t["default"]=u.exports},"455e":function(e,t,n){},"70b3":function(e,t,n){"use strict";(function(e){var i=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n("7eb4")),a=i(n("34cf")),o=i(n("ee10")),u=n("8f59"),s={components:{WCompress:function(){Promise.all([n.e("common/vendor"),n.e("components/w-compress/w-compress")]).then(function(){return resolve(n("c48e"))}.bind(null,n)).catch(n.oe)}},props:{imagelist:{type:Array,default:function(){return[]}},imgtype:{type:String,default:function(){return""}},imgsize:{type:Number,default:function(){return 9}},filetype:{type:String,default:function(){return"picture"}},imgclass:{type:String,default:function(){return""}},text:{type:String,default:function(){return""}},videoSize:{type:Number,default:function(){return 50}},sourceType:{type:Number,default:function(){return 1}},isEdit:{type:Boolean,default:function(){return!0}},isCompress:{type:Boolean,default:function(){return!0}}},computed:(0,u.mapState)({primaryColor:function(e){return e.config.configInfo.primaryColor},subColor:function(e){return e.config.configInfo.subColor},userInfo:function(e){return e.user.userInfo}}),methods:{previewImage:function(t,n){var i=[];n=this.$util.deepCopy(n),n.forEach((function(e,t){i.push(e.path)})),e.previewImage({current:t.path,urls:i})},toDel:function(t){var n=this;return(0,o.default)(r.default.mark((function i(){var o,u,s,c;return r.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return o="picture"==n.filetype?"图片":"视频",i.next=3,e.showModal({content:"请确认是否要删除".concat(o)});case 3:if(u=i.sent,s=(0,a.default)(u,2),s[0],c=s[1].confirm,c){i.next=9;break}return i.abrupt("return");case 9:n.imagelist.splice(t,1),n.$emit("del",{imgtype:n.imgtype,imagelist:n.imagelist});case 11:case"end":return i.stop()}}),i)})))()},chooseImage:function(){var t=this;return(0,o.default)(r.default.mark((function n(){var i,o,u,s,c,l,f,p,d,m,g,h,y,b,v,w,x,$,k,C,I,z,P,_;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=t.$refs.user_privacy.check(),!i){n.next=4;break}return t.$refs.user_privacy.open(),n.abrupt("return");case 4:return o=t.imgtype,u=t.imgsize,s=t.filetype,c=t.videoSize,l=t.sourceType,f=t.isCompress,p=t.$util.deepCopy(t.imagelist),d="picture"==s,m=d?"chooseImage":"chooseVideo",1,g=1==u?1:u-1*p.length,h={count:g},d&&(h.sizeType=["compressed"]),h.sourceType=1==l?["camera","album"]:["camera"],n.next=15,e[m](h);case 15:if(y=n.sent,b=(0,a.default)(y,2),v=b[0],w=b[1],!v){n.next=21;break}return n.abrupt("return");case 21:if(x=w.size,$=void 0===x?0:x,k=w.tempFiles,C=w.tempFilePath,I=void 0===C?"":C,console.log(d,$,$/1024/1024,"=====size"),!("video"==s&&$/1024/1024>c)){n.next=26;break}return t.$util.showToast({title:"上传视频大小超过限制".concat(c,"M")}),n.abrupt("return");case 26:if([],!d){n.next=32;break}z=k.map((function(e){return e.path})),f?(e.showLoading({title:"图片压缩中...",mask:!0}),t.$refs.wCompress.start(z,{pixels:1e6,quality:.9}).then((function(e){t.$util.hideAll(),t.toCompressImg(e,o,u,p)})).catch((function(e){console.log(e),t.$util.hideAll()}))):t.toCompressImg(z,o,u,p),n.next=40;break;case 32:return t.$util.showLoading({title:"上传中"}),n.next=35,t.$api.base.uploadFile({filePath:I,formData:{type:t.filetype}});case 35:P=n.sent,_=P.attachment_path,p.push({path:_}),t.$util.hideAll(),t.$emit("upload",{imgtype:o,imagelist:p});case 40:case"end":return n.stop()}}),n)})))()},toCompressImg:function(e,t,n,i){var a=this;return(0,o.default)(r.default.mark((function o(){var u,s,c;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:a.$util.showLoading({title:"上传中"}),u=0;case 2:if(!(u<e.length)){r.next=11;break}return r.next=5,a.$api.base.uploadFile({filePath:e[u],formData:{type:a.filetype}});case 5:s=r.sent,c=s.attachment_path,n>1?i.push({path:c}):i=[{path:c}];case 8:u++,r.next=2;break;case 11:a.$util.hideAll(),a.$emit("upload",{imgtype:t,imagelist:i});case 13:case"end":return r.stop()}}),o)})))()},onPlay:function(e){},onPause:function(e){},onEnded:function(e){},onTimeUpdate:function(e){},onWaiting:function(e){},onProgress:function(e){},onLoadedMetaData:function(e){}}};t.default=s}).call(this,n("df3c")["default"])},d067:function(e,t,n){"use strict";n.r(t);var i=n("70b3"),r=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=r.a},e251:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));var i={wCompress:function(){return Promise.all([n.e("common/vendor"),n.e("components/w-compress/w-compress")]).then(n.bind(null,"c48e"))}},r=function(){var e=this,t=e.$createElement,n=(e._self._c,e.imagelist.length<e.imgsize&&e.isEdit),i=n&&e.imgsize>1?e.imagelist.length:null,r=e.imagelist.length<e.imgsize&&!e.isEdit;e.$mp.data=Object.assign({},{$root:{g0:n,g1:i,g2:r}})},a=[]},e2e6:function(e,t,n){"use strict";var i=n("455e"),r=n.n(i);r.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/upload-create-component',
    {
        'components/upload-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('df3c')['createComponent'](__webpack_require__("2659"))
        })
    },
    [['components/upload-create-component']]
]);
