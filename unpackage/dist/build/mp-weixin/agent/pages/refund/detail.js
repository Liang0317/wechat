(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["agent/pages/refund/detail"],{"030c":function(e,t,n){"use strict";n.r(t);var r=n("4e57"),a=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=a.a},"35ba":function(e,t,n){"use strict";(function(e,t){var r=n("47a9");n("65e9");r(n("3240"));var a=r(n("7aba"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"4e57":function(e,t,n){"use strict";(function(e){var r=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("7eb4")),i=r(n("ee10")),o=r(n("7ca3")),u=n("8f59");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={components:{},data:function(){return{options:{},carType:{0:"公交/地铁",1:"出租车"},payType:{1:"微信支付",2:"余额支付",3:"支付宝支付"},statusType:{"-1":"已取消",1:"待退款",2:"同意退款",3:"拒绝退款",4:"退款中",5:"退款失败"},detail:{pay_type:0},lockTap:!1,popupInfo:{}}},computed:(0,u.mapState)({primaryColor:function(e){return e.config.configInfo.primaryColor},subColor:function(e){return e.config.configInfo.subColor},configInfo:function(e){return e.config.configInfo},userInfo:function(e){return e.user.userInfo},over_time_text:function(){return(new Date).getTime()+1e3*this.detail.end_time}}),onLoad:function(e){var t=e.agent,n=void 0===t?0:t;e.agent=1*n,this.options=e,this.initIndex()},methods:s(s(s({},(0,u.mapActions)(["getConfigInfo","getCoachInfo"])),(0,u.mapMutations)(["updateTechnicianItem"])),{},{initIndex:function(){var e=arguments,t=this;return(0,i.default)(a.default.mark((function n(){var r,i,o,u,c,s,l;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.length>0&&void 0!==e[0]&&e[0],t.configInfo.id&&!r){n.next=4;break}return n.next=4,t.getConfigInfo();case 4:return i=t.options,o=i.id,u=i.agent,c=u?"agent":"admin",n.next=8,t.$api[c].refundOrderInfo({id:o});case 8:s=n.sent,l=0,s.order_goods.map((function(e){l+=e.refund_material_price*e.num})),s.refund_material_price=l.toFixed(2),t.$util.setNavigationBarColor({bg:t.primaryColor}),s.is_balance=1*s.balance>0?1:0,t.detail=s;case 15:case"end":return n.stop()}}),n)})))()},initRefresh:function(){this.initIndex(!0)},toConfirm:function(e){var t=this;return(0,i.default)(a.default.mark((function n(){var r,i,o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.detail,i=r.id,o=r.apply_price,t.popupInfo={id:i,type:e,apply_price:o,price:2==e?o:"",text:""},t.$refs.change_item.open();case 3:case"end":return n.stop()}}),n)})))()},confirmChangeOrder:function(){var e=this;return(0,i.default)(a.default.mark((function t(){var n,r,i,o,u,c,s,l,f;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.popupInfo,r=n.type,i=n.price,o=n.apply_price,u=e.$util.pick(e.popupInfo,["id","price","text"]),c=/^(([0-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/,2!=r||i&&c.test(i)&&!(1*i>1*o)){t.next=6;break}return e.$util.showToast({title:i?c.test(i)?"退款金额不能大于可退款金额":"请输入正确的退款金额，最多保留2位小数":"请输入退款金额"}),t.abrupt("return");case 6:if(!e.lockTap){t.next=8;break}return t.abrupt("return");case 8:return e.lockTap=!0,e.$util.showLoading(),s=e.options.agent,l=s?"agent":"admin",f=2==r?"passRefund":"noPassRefund",t.prev=13,t.next=16,e.$api[l][f](u);case 16:e.$refs.change_item.close(),e.$util.showToast({title:"操作成功"}),e.lockTap=!1,e.updateTechnicianItem({key:"haveOperItem",val:!0}),e.initRefresh(),e.$util.back(),t.next=28;break;case 24:return t.prev=24,t.t0=t["catch"](13),setTimeout((function(){e.lockTap=!1,e.$util.hideAll()}),2e3),t.abrupt("return");case 28:case"end":return t.stop()}}),t,null,[[13,24]])})))()},toTel:function(){var e=this;return(0,i.default)(a.default.mark((function t(){var n,r,i,o,u,c;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.detail,r=n.order_id,i=n.status,o=e.options.agent,u=o?"agent":"admin",![1,3].includes(i)){t.next=13;break}return t.next=6,e.$api[u].getVirtualPhone({order_id:r});case 6:if(c=t.sent,c){t.next=10;break}return e.$util.showToast({title:"稍后会有电话打入，请注意接听哦"}),t.abrupt("return");case 10:e.$util.goUrl({url:c,openType:"call"}),t.next=14;break;case 13:e.$util.showToast({title:"退款成功，不能联系客户哦"});case 14:case"end":return t.stop()}}),t)})))()},toMap:function(t){var n=this;return(0,i.default)(a.default.mark((function r(){var i,o,u,c,s,l,f;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(i=n.$refs.user_privacy.check(),!i){r.next=4;break}return n.$refs.user_privacy.open(),r.abrupt("return");case 4:return o=n.detail[t],u=o.address,c=o.address_info,s=void 0===c?"":c,l=o.lat,f=o.lng,r.next=7,n.$util.checkAuth({type:"userLocation"});case 7:return r.next=9,e.getLocation({type:"gcj02"});case 9:return r.next=11,e.openLocation({latitude:1*l,longitude:1*f,name:s?"".concat(u," ").concat(s):u,scale:28});case 11:case"end":return r.stop()}}),r)})))()},toCopy:function(e){var t=this.$refs.user_privacy.check();t?this.$refs.user_privacy.open():this.$util.goUrl({url:e,openType:"copy"})}})};t.default=l}).call(this,n("df3c")["default"])},"7aba":function(e,t,n){"use strict";n.r(t);var r=n("b384"),a=n("030c");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n("fd16");var o=n("828b"),u=Object(o["a"])(a["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],void 0);t["default"]=u.exports},b384:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var r=function(){var e=this,t=e.$createElement,n=(e._self._c,e.detail.id?e.__map(e.detail.order_goods,(function(t,n){var r=e.__get_orig(t),a=e.detail.order_goods.length;return{$orig:r,g0:a}})):null),r=e.detail.id&&!e.detail.phone_encryption?e.detail.address_info.mobile.substring(0,3):null,a=e.detail.id&&!e.detail.phone_encryption?e.detail.address_info.mobile.substring(7,11):null,i=e.detail.id?e.detail.imgs&&e.detail.imgs.length>0:null,o=e.detail.id?[1,5].includes(e.detail.status):null;e._isMounted||(e.e0=function(t){t.stopPropagation(),5==e.detail.status&&e.detail.failure_reason&&e.$refs.show_rule_item.open()},e.e1=function(t){return t.stopPropagation(),e.$util.goUrl({url:e.detail.store_info.phone,openType:"call"})},e.e2=function(t){return e.$util.goUrl({url:"/agent/pages/refund/refund?id="+e.options.id+"&agent="+e.options.agent+"&detail=1"})},e.e3=function(t){return t.stopPropagation(),e.$refs.change_item.close()},e.e4=function(t){return t.stopPropagation(),e.$refs.show_rule_item.close()}),e.$mp.data=Object.assign({},{$root:{l0:n,g1:r,g2:a,g3:i,g4:o}})},a=[]},c9c2:function(e,t,n){},fd16:function(e,t,n){"use strict";var r=n("c9c2"),a=n.n(r);a.a}},[["35ba","common/runtime","common/vendor"]]]);