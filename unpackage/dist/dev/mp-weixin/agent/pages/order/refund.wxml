<block wx:if="{{isLoad}}"><view class="user-order-refund"><block wx:for="{{$root.l1}}" wx:for-item="item" wx:for-index="index" wx:key="index"><block><block wx:if="{{item.g0}}"><view class="fill-base pd-lg mt-md ml-md mr-md radius-16"><view class="f-title c-title text-bold pb-lg">首单项目</view><block wx:for="{{item.l0}}" wx:for-item="aitem" wx:for-index="aindex" wx:key="*this"><block><view class="{{['item-child','flex-warp',[(aindex!=0)?'mt-lg':''],[(aitem.g1)?'pb-lg b-1px-b':'']]}}"><view data-event-opts="{{[['tap',[['handleCheckOrderItem',[1,index,aindex]]]]]}}" class="flex-y-center" style="height:147rpx;" bindtap="__e"><view class="{{['iconfont','mr-md','_i',[(!aitem.$orig.is_check)?'icon-xuanze':''],[(aitem.$orig.is_check)?'icon-xuanze-fill':'']]}}" style="{{'color:'+(aitem.$orig.is_check?primaryColor:'#CACACA')+';'}}"></view></view><view class="flex-1"><view data-event-opts="{{[['tap',[['handleCheckOrderItem',[1,index,aindex]]]]]}}" class="flex-warp" bindtap="__e"><image class="goods-img" mode="aspectFill" src="{{aitem.$orig.goods_cover}}"></image><view class="flex-1 ml-md"><view class="flex-between"><view class="f-title c-title text-bold max-300 ellipsis">{{aitem.$orig.goods_name+''}}</view><view class="f-desc" style="{{'color:'+(item.$orig.pay_type==2?primaryColor:aitem.g2?subColor:item.$orig.pay_type==6?'#11C95E':'#333')+';'}}">{{''+statusType[item.$orig.pay_type]+''}}</view></view><view class="f-caption c-caption mt-sm" style="height:30rpx;"><block wx:if="{{aitem.$orig.material_price*1>0}}"><block>{{"物料费：¥"+aitem.$orig.material_price}}</block></block></view><view class="flex-between mt-md"><view class="f-desc c-warning text-bold">{{"¥"+aitem.$orig.true_price+''}}</view><view class="f-desc" style="color:#4D4D4D;">{{"x"+aitem.$orig.can_refund_num}}</view></view></view></view><block wx:if="{{aitem.$orig.is_check}}"><view class="mt-sm"><block wx:if="{{aitem.$orig.true_price*1>0}}"><view class="flex-between f-paragraph mt-md"><view class="c-paragraph">项目金额</view><view class="flex-y-center c-title"><input class="text-right" type="number" placeholder="请输入物料费" data-event-opts="{{[['input',[['__set_model',['$0','refund_price','$event',[]],['refundForm.order.'+index+'.order_goods.'+aindex+'']],['checkInput',['$event',index,aindex,'refund_price']]]],['blur',[['handleCheckOrderItem',[0,index,aindex]]]]]}}" value="{{refundForm.order[index].order_goods[aindex].refund_price}}" bindinput="__e" bindblur="__e"/><view class="ml-sm">元</view></view></view></block><block wx:if="{{aitem.$orig.material_price*1>0}}"><view class="flex-between f-paragraph mt-md"><view class="c-paragraph">物料费</view><view class="flex-y-center c-title"><input class="text-right" type="number" placeholder="请输入物料费" data-event-opts="{{[['input',[['__set_model',['$0','refund_material_price','$event',[]],['refundForm.order.'+index+'.order_goods.'+aindex+'']],['checkInput',['$event',index,aindex,'refund_material_price']]]],['blur',[['handleCheckOrderItem',[0,index,aindex]]]]]}}" value="{{refundForm.order[index].order_goods[aindex].refund_material_price}}" bindinput="__e" bindblur="__e"/><view class="ml-sm">元</view></view></view></block><view class="flex-between f-paragraph mt-md"><view class="c-paragraph">退款数量</view><view class="flex-warp"><button data-event-opts="{{[['tap',[['changeNum',[index,aindex,-1]]]]]}}" class="reduce" style="{{'border-color:'+(primaryColor)+';'+('color:'+(primaryColor)+';')}}" catchtap="__e"><view class="iconfont icon-jian-bold _i"></view></button><button class="addreduce clear-btn">{{aitem.$orig.refund_num}}</button><button data-event-opts="{{[['tap',[['changeNum',[index,aindex,1]]]]]}}" class="add" style="{{'background:'+(primaryColor)+';'+('border-color:'+(primaryColor)+';')}}" catchtap="__e"><view class="iconfont icon-jia-bold _i"></view></button></view></view><view class="flex-between f-paragraph mt-md"><view class="c-paragraph">累计退款金额</view><view class="c-title text-bold">{{"¥"+aitem.$orig.total_refund_price}}</view></view></view></block></view></view></block></block><view class="flex-between f-paragraph pt-lg mt-lg b-1px-t"><view class="c-paragraph">服务时间</view><view class="c-title">{{item.$orig.time_text}}</view></view></view></block></block></block><block wx:if="{{$root.g3>1}}"><view class="fill-base pd-lg mt-md ml-md mr-md radius-16"><block wx:for="{{$root.l3}}" wx:for-item="item" wx:for-index="index" wx:key="index"><block><block wx:if="{{item.g4}}"><block><block wx:if="{{index==1}}"><view class="f-title c-title text-bold">加钟项目</view></block><block wx:for="{{item.l2}}" wx:for-item="aitem" wx:for-index="aindex" wx:key="*this"><block><view class="{{['item-child','flex-warp','mt-lg',[(aitem.g5)?'pb-lg b-1px-b':'']]}}"><view data-event-opts="{{[['tap',[['handleCheckOrderItem',[1,index,aindex]]]]]}}" class="flex-y-center" style="height:147rpx;" bindtap="__e"><view class="{{['iconfont','mr-md','_i',[(!aitem.$orig.is_check)?'icon-xuanze':''],[(aitem.$orig.is_check)?'icon-xuanze-fill':'']]}}" style="{{'color:'+(aitem.$orig.is_check?primaryColor:'#CACACA')+';'}}"></view></view><view class="flex-1"><view data-event-opts="{{[['tap',[['handleCheckOrderItem',[1,index,aindex]]]]]}}" class="flex-warp" bindtap="__e"><image class="goods-img" mode="aspectFill" src="{{aitem.$orig.goods_cover}}"></image><view class="flex-1 ml-md"><view class="flex-between"><view class="f-title c-title text-bold max-300 ellipsis">{{''+aitem.$orig.goods_name+''}}</view><view class="f-desc" style="{{'color:'+(item.$orig.pay_type==2?primaryColor:aitem.g6?subColor:item.$orig.pay_type==6?'#11C95E':'#333')+';'}}">{{''+statusType[item.$orig.pay_type]+''}}</view></view><view class="f-caption c-caption mt-sm" style="height:30rpx;"><block wx:if="{{aitem.$orig.material_price*1>0}}"><block>{{"物料费：¥"+aitem.$orig.material_price+''}}</block></block></view><view class="flex-between mt-md"><view class="f-desc c-warning text-bold">{{"¥"+aitem.$orig.true_price+''}}</view><view class="f-desc" style="color:#4D4D4D;">{{"x"+aitem.$orig.can_refund_num}}</view></view></view></view><block wx:if="{{aitem.$orig.is_check}}"><view class="mt-sm"><block wx:if="{{aitem.$orig.true_price*1>0}}"><view class="flex-between f-paragraph mt-md"><view class="c-paragraph">项目金额</view><view class="flex-y-center c-title"><input class="text-right" type="number" placeholder="请输入物料费" data-event-opts="{{[['input',[['__set_model',['$0','refund_price','$event',[]],['refundForm.order.'+index+'.order_goods.'+aindex+'']],['checkInput',['$event',index,aindex,'refund_price']]]],['blur',[['handleCheckOrderItem',[0,index,aindex]]]]]}}" value="{{refundForm.order[index].order_goods[aindex].refund_price}}" bindinput="__e" bindblur="__e"/><view class="ml-sm">元</view></view></view></block><block wx:if="{{aitem.$orig.material_price*1>0}}"><view class="flex-between f-paragraph mt-md"><view class="c-paragraph">物料费</view><view class="flex-y-center c-title"><input class="text-right" type="number" placeholder="请输入物料费" data-event-opts="{{[['input',[['__set_model',['$0','refund_material_price','$event',[]],['refundForm.order.'+index+'.order_goods.'+aindex+'']],['checkInput',['$event',index,aindex,'refund_material_price']]]],['blur',[['handleCheckOrderItem',[0,index,aindex]]]]]}}" value="{{refundForm.order[index].order_goods[aindex].refund_material_price}}" bindinput="__e" bindblur="__e"/><view class="ml-sm">元</view></view></view></block><view class="flex-between f-paragraph mt-md"><view class="c-paragraph">退款数量</view><view class="flex-warp"><button data-event-opts="{{[['tap',[['changeNum',[index,aindex,-1]]]]]}}" class="reduce" style="{{'border-color:'+(primaryColor)+';'+('color:'+(primaryColor)+';')}}" catchtap="__e"><view class="iconfont icon-jian-bold _i"></view></button><button class="addreduce clear-btn">{{aitem.$orig.refund_num}}</button><button data-event-opts="{{[['tap',[['changeNum',[index,aindex,1]]]]]}}" class="add" style="{{'background:'+(primaryColor)+';'+('border-color:'+(primaryColor)+';')}}" catchtap="__e"><view class="iconfont icon-jia-bold _i"></view></button></view></view><view class="flex-between f-paragraph mt-md"><view class="c-paragraph">累计退款金额</view><view class="c-title text-bold">{{"¥"+aitem.$orig.total_refund_price}}</view></view></view></block></view></view></block></block><view class="flex-between f-paragraph pt-lg mt-lg b-1px-t"><view class="c-paragraph">服务时间</view><view class="c-title">{{item.$orig.time_text}}</view></view></block></block></block></block></view></block><view class="fill-base pd-lg mt-md ml-md mr-md radius-16"><block wx:if="{{refundForm.car_price*1>0}}"><view class="flex-between f-paragraph mb-md"><view class="c-paragraph">车费</view><block wx:if="{{refundForm.can_refund_num===refundForm.all_refund_num}}"><view class="flex-y-center c-title"><input class="text-right" type="number" placeholder="请输入车费" data-event-opts="{{[['input',[['__set_model',['$0','refund_car_price','$event',[]],['refundForm']],['checkInput',['$event',-1,-1,'refund_car_price']]]],['blur',[['handleCheckOrderItem',[3]]]]]}}" value="{{refundForm.refund_car_price}}" bindinput="__e" bindblur="__e"/><view class="ml-sm">元</view></view></block><block wx:else><view class="c-title">{{"¥"+refundForm.refund_car_price}}</view></block></view></block><block wx:if="{{refundForm.discount*1>0}}"><view class="flex-between f-paragraph mb-md"><view class="c-paragraph">卡券抵扣</view><view class="c-title">{{"¥"+refundForm.discount}}</view></view></block><view class="flex-between f-paragraph"><view class="c-paragraph">总计</view><view class="c-warning text-bold">{{"¥"+refundForm.total_refund_price}}</view></view></view><view class="space-max-footer"></view><view class="refund-bottom-info fill-base fix pl-lg pr-lg"><view class="flex-between"><view><block wx:if="{{refundForm.can_refund_num>0}}"><view data-event-opts="{{[['tap',[['handleCheckOrderItem',[2]]]]]}}" class="flex-y-center" bindtap="__e"><view class="{{['iconfont','mr-md','_i',[(!refundForm.is_check)?'icon-xuanze':''],[(refundForm.is_check)?'icon-xuanze-fill':'']]}}" style="{{'color:'+(refundForm.is_check?primaryColor:'#CACACA')+';'}}"></view>全选</view></block></view><view class="flex-center"><button data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="clear-btn order" catchtap="__e">取消</button><button data-event-opts="{{[['tap',[['toConfirmRefund',['$event']]]]]}}" class="clear-btn order" style="{{'color:'+('#fff')+';'+('background:'+(primaryColor)+';')+('border-color:'+(primaryColor)+';')}}" catchtap="__e">确认</button></view></view><view class="space-safe"></view></view></view></block>